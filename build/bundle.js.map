{"version":3,"sources":["webpack:///webpack/bootstrap d6d52ebcbf1ffc72e91b","webpack:///./js/Vector.js","webpack:///./js/MapSerializer.js","webpack:///./js/Game.js","webpack:///./css/main.css?b1a5","webpack:///./js/BSPTree.js","webpack:///./js/DefaultMap.js","webpack:///./js/Map.js","webpack:///./js/MapObject.js","webpack:///./js/MapScreen.js","webpack:///./js/Objective.js","webpack:///./js/Polygon.js","webpack:///./js/PolygonRenderer.js","webpack:///./js/Tile.js","webpack:///./js/Viewport.js","webpack:///./js/main.js","webpack:///./~/css-loader/lib/css-base.js","webpack:///./~/style-loader/lib/urls.js","webpack:///./css/main.css","webpack:///./~/style-loader/lib/addStyles.js"],"names":["Point","x","y","z","p","perc","getX","getY","getZ","v","rad","cost","Math","cos","sint","sin","mcost","vx","vy","vz","dot","newx","newy","newz","s","Vector","mag","sqrt","p1","p2","serialize","map","mapString","tiles","getTiles","i","length","tileRow","j","tile","tileString","mapObjects","getMapObjects","mapObject","mapObjectString","getObjective","serializeTurnPlayers","serializeActions","deserialize","splitString","split","tileArrayString","mapObjectArrayString","settings","tileRowStrings","tileStrings","props","tileClass","getClass","link","push","mapObjectStrings","objective","turnPlayers","deserializeTurnPlayers","actions","deserializeActions","Game","width","height","canvas","document","createElement","body","appendChild","screen","start","window","dmap","addEventListener","e","rect","getBoundingClientRect","handleClick","clientX","left","clientY","top","handleMouseDown","handleMouseMove","handleMouseUp","handleMouseLeave","preventDefault","handleKeyDown","code","handleKeyUp","BSPTree","faces","nodes","front","back","p0","getPoints","n","getNormal","frontFaces","backFaces","pos","cut","frontPoints","backPoints","points","lastD","createFromPoints","abs","d","prevP","prevD","mid","midpoint","getPolygon","splitFace","face1","face2","face","addFace","forEach","idx","indexOf","splice","removeFace","fn","viewport","viewDir","getViewDir","traverse","exampleMapString","defaultMap","Map","turnPlayer","turnPlayerIdx","listeners","flattenedArray","row","concat","getTilesFlattened","t","getMapObject","filter","m","ret","move","transfer","attack","check","name","sx","sy","dx","dy","srcTile","obj","dstTile","l","trigger","Error","Object","values","reduce","a","b","str","parseInt","MapObject","setMapObject","getH","constructor","cls","NAME_MAP","slice","Shard","unsetMapObject","BlueShard","RedShard","YellowShard","Vessel","arguments","player","movement","range","mO","getPlayer","getShard","consumeShard","WhiteVessel","getNeighbors","has","attackedBy","paths","getPaths","key","undefined","path","shard","BlueVessel","RedVessel","YellowVessel","bs","rs","ys","w","r","TLEN","MapScreen","pressed","tilePolygons","createBox","objPolygons","createIcosahedron","setColor","renderer","addListener","renderLoop","updatePosition","rotate","PI","objs","render","requestAnimationFrame","step","animations","rate","dz","frames","queueAnimations","turnActor","mapRenderer","centerOn","setMouse","updateRates","t1","t3","t2","r1","r2","Objective","num","success","OBJECT_FNS","players","enemies","Polygon","type","setPolygon","clippedFace","hover","originalFaces","color","highlightColor","Array","from","Set","point","translate","animation","sz","newFacePoints","clippedPoints","getClippedPoints","c","minDist","minDistIdx","match","cp","nextcp","currDist","getMag","cDist1","cDist2","distInc","PolygonFace","setVisiblePoints","points1","points2","blacklist","getEdgeBlacklist","sharedPoints","f","newBlacklist","idx1","idx2","nidx","pidx","np","pp","v1","normalize","v2","setEdgeBlacklist","h","scale","p3","cross","unitNormal","normal","polygon","visiblePoints","mapping","edgeBlacklist","ctx","fillStyle","getColor","beginPath","k","moveTo","lineTo","fill","nextK","edge","strokeStyle","stroke","PolygonRenderer","staticPolygons","faceSort","staticFaces","getFaces","sort","bsp","hoveredPolygon","polygons","getContext","clearRect","facesToDraw","hoveredFace","addFaces","projectFace","visible","mouseInside","removeFaces","calcClippedFace","getClippedFace","getVisiblePoints","toggleHover","draw","restoreFaces","Tile","right","down","dir","dist","dirs","queue","nextQueue","thisKey","movable","tkey","add","moveable","TILE_MAP","PlainTile","EmptyTile","Viewport","p4","calcVectors","rates","mx","my","viewVector","pointVector","pz","li","lz","ri","rz","projected","threshold","p5","basis1","basis2","threshhold","vector","cosTheta","acos","xDist","yDist","zDist","copy","s1","s2","s3","calc","theta1","theta2","theta3","rad1","rad2","rad3","Promise","resolve","reject","endpoint","rotateByBasis","translateAlongBasis","zPos","px","py","g","innerWidth","innerHeight","module","exports","useSourceMap","list","toString","item","content","cssWithMappingToString","join","modules","mediaQuery","alreadyImportedModules","id","cssMapping","btoa","sourceMapping","toComment","sourceURLs","sources","source","sourceRoot","sourceMap","base64","unescape","encodeURIComponent","JSON","stringify","data","css","location","baseUrl","protocol","host","currentDir","pathname","replace","fixedCss","fullMatch","origUrl","unquotedOrigUrl","trim","o","$1","test","newUrl"],"mappings":"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AA4B,GAAG;;AAEjE;;;;;;;ACPA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;AACD;AACA,CAAC;;AAED;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA,iBAAiB,mBAAmB;AACpC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,iBAAiB,sBAAsB;AACvC;;AAEA;AACA,mBAAmB,2BAA2B;;AAE9C;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB,mBAAmB;AACnC;AACA;;AAEA;AACA;;AAEA,iBAAiB,2BAA2B;AAC5C;AACA;;AAEA,QAAQ,uBAAuB;AAC/B;AACA;AACA,GAAG;AACH;;AAEA,iBAAiB,uBAAuB;AACxC;AACA;;AAEA,2BAA2B;AAC3B;AACA;AACA;;AAEA;AACA;AACA;;AAEA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;AACA,cAAc;;AAEd,kDAAkD,sBAAsB;AACxE;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uDAAuD;AACvD;;AAEA,6BAA6B,mBAAmB;;AAEhD;;AAEA;;AAEA;AACA","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 14);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d6d52ebcbf1ffc72e91b","class Point {\n\n    constructor(x, y, z) {\n        this.x = x;\n        this.y = y;\n        this.z = z;\n    }\n\n    midpoint(p, perc) {\n        const x = (1 - perc) * this.x + perc * p.getX();\n        const y = (1 - perc) * this.y + perc * p.getY();\n        const z = (1 - perc) * this.z + perc * p.getZ();\n        return new Point(x, y, z);\n    }\n\n    getX() {\n        return this.x;\n    }\n\n    getY() {\n        return this.y;\n    }\n\n    getZ() {\n        return this.z;\n    }\n\n    translate(x, y, z) {\n        this.x += x;\n        this.y += y;\n        this.z += z;\n    }\n\n    rotate(v, rad) {\n        const cost = Math.cos(rad);\n        const sint = Math.sin(rad);\n        const mcost = 1 - cost;\n        const vx = v.getX();\n        const vy = v.getY();\n        const vz = v.getZ();\n        const dot = this.x * vx + this.y * vy + this.z * vz;\n        const newx = this.x * cost + (vy * this.z - vz * this.y) * sint + vx * dot * mcost;\n        const newy = this.y * cost + (vz * this.x - vx * this.z) * sint + vy * dot * mcost;\n        const newz = this.z * cost + (vx * this.y - vy * this.x) * sint + vz * dot * mcost;\n        this.x = newx;\n        this.y = newy;\n        this.z = newz;\n    }\n\n    scale(s) {\n        this.x *= s;\n        this.y *= s;\n        this.z *= s;\n    }\n\n    dot(p) {\n        return this.x * p.getX() + this.y * p.getY() + this.z * p.getZ();\n    }\n\n    copy() {\n        return new Point(this.x, this.y, this.z);\n    }\n\n    equals(p) {\n        return this.x === p.getX() && this.y === p.getY() && this.z === p.getZ();\n    }\n}\n\nclass Vector {\n\n    constructor(x, y, z) {\n        this.x = x;\n        this.y = y;\n        this.z = z;\n        this.mag = Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\n    }\n\n    static createFromPoints(p1, p2) {\n        return new Vector(p2.getX() - p1.getX(), p2.getY() - p1.getY(), p2.getZ() - p1.getZ());\n    }\n\n    getX() {\n        return this.x;\n    }\n\n    getY() {\n        return this.y;\n    }\n\n    getZ() {\n        return this.z;\n    }\n\n    getMag() {\n        return this.mag;\n    }\n\n    normalize() {\n        this.x = this.x / this.mag;\n        this.y = this.y / this.mag;\n        this.z = this.z / this.mag;\n        this.mag = 1;\n    }\n\n    cross(v) {\n        const vx = v.getX();\n        const vy = v.getY();\n        const vz = v.getZ();\n        const x = this.y * vz - this.z * vy;\n        const y = this.z * vx - this.x * vz;\n        const z = this.x * vy - this.y * vx;\n        return new Vector(x, y, z);\n    }\n\n    dot(v) {\n        return this.x * v.getX() + this.y * v.getY() + this.z * v.getZ();\n    }\n\n    equals(v) {\n        return this.x === v.getX() && this.y === v.getY() && this.z === v.getZ();\n    }\n\n    rotate(v, rad) {\n        const cost = Math.cos(rad);\n        const sint = Math.sin(rad);\n        const mcost = 1 - cost;\n        const vx = v.getX();\n        const vy = v.getY();\n        const vz = v.getZ();\n        const dot = this.x * vx + this.y * vy + this.z * vz;\n        const newx = this.x * cost + (vy * this.z - vz * this.y) * sint + vx * dot * mcost;\n        const newy = this.y * cost + (vz * this.x - vx * this.z) * sint + vy * dot * mcost;\n        const newz = this.z * cost + (vx * this.y - vy * this.x) * sint + vz * dot * mcost;\n        this.x = newx;\n        this.y = newy;\n        this.z = newz;\n    }\n}\n\nexport { Point, Vector };\n\n\n// WEBPACK FOOTER //\n// ./js/Vector.js","import { Tile } from \"./Tile\";\nimport { MapObject } from \"./MapObject\";\nimport { Map } from './Map';\nimport { Objective } from './Objective';\n\nfunction serialize(map) {\n    let mapString = '';\n    const tiles = map.getTiles();\n    for (let i = 0; i < tiles.length; i++) {\n        const tileRow = tiles[i];\n        for (let j = 0; j < tileRow.length; j++) {\n            const tile = tileRow[j];\n            const tileString = tile.serialize();\n            mapString += tileString;\n            if (j !== tileRow.length - 1) {\n                mapString += ' ';\n            }\n        }\n        mapString += '\\n';\n    }\n    mapString += '===\\n';\n    const mapObjects = map.getMapObjects();\n    for (let i = 0; i < mapObjects.length; i++) {\n        const mapObject = mapObjects[i];\n        const mapObjectString = mapObject.serialize();\n        mapString += mapObjectString;\n        mapString += '\\n';\n    }\n    mapString += '===\\n';\n    mapString += map.getObjective().serialize();\n    mapString += '\\n';\n    mapString += map.serializeTurnPlayers();\n    mapString += '\\n';\n    mapString += map.serializeActions();\n    return mapString;\n}\n\nfunction deserialize(mapString) {\n    const splitString = mapString.split('\\n===\\n');\n    const tileArrayString = splitString[0];\n    const mapObjectArrayString = splitString[1];\n    const settings = splitString[2].split('\\n');\n\n    const tiles = [];\n    const tileRowStrings = tileArrayString.split('\\n');\n    for (let y = 0; y < tileRowStrings.length; y++) {\n        const tileRow = [];\n        const tileStrings = tileRowStrings[y].split(' ');\n        for (let x = 0; x < tileStrings.length; x++) {\n            const props = tileStrings[x].split('-');\n            const tileClass = Tile.getClass(props[0]);\n            const tile = new tileClass(x, y, props[1]);\n\n            if (x > 0) {\n                tile.link('left', tileRow[x - 1]);\n                tileRow[x - 1].link('right', tile);\n            }\n            if (y > 0) {\n                tile.link('top', tiles[y - 1][x]);\n                tiles[y - 1][x].link('down', tile);\n            }\n            tileRow.push(tile);\n        }\n        tiles.push(tileRow);\n    }\n\n    const mapObjectStrings = mapObjectArrayString.split('\\n');\n    for (let i = 0; i < mapObjectStrings.length; i++) {\n        const mapObject = MapObject.deserialize(mapObjectStrings[i], tiles);\n    }\n\n    const objective = Objective.deserialize(settings[0]);\n    const turnPlayers = Map.deserializeTurnPlayers(settings[1]);\n    const actions = Map.deserializeActions(settings[2]);\n    return new Map(tiles, objective, turnPlayers, actions);\n}\n\nexport { serialize, deserialize }\n\n\n\n// WEBPACK FOOTER //\n// ./js/MapSerializer.js","import { MapScreen } from \"./MapScreen\";\nimport DefaultMap from \"./DefaultMap\";\n\nexport default class Game {\n    constructor(width, height) {\n        this.canvas = document.createElement(\"canvas\");\n        this.canvas.width = width;\n        this.canvas.height = height;\n    }\n\n    start() {\n        document.body.appendChild(this.canvas);\n        this.screen = new MapScreen(this.canvas, DefaultMap);\n        this.screen.start();\n        window.dmap = DefaultMap;\n    \n        this.canvas.addEventListener(\"click\", (e) => {\n            const rect = this.canvas.getBoundingClientRect();\n            this.screen.handleClick(e.clientX - rect.left, e.clientY - rect.top);\n        });\n\n        this.canvas.addEventListener(\"mousedown\", (e) => {\n            const rect = this.canvas.getBoundingClientRect();\n            this.screen.handleMouseDown(e.clientX - rect.left, e.clientY - rect.top);\n        });\n\n        this.canvas.addEventListener(\"mousemove\", (e) => {\n            const rect = this.canvas.getBoundingClientRect();\n            this.screen.handleMouseMove(e.clientX - rect.left, e.clientY - rect.top);\n        });\n\n        this.canvas.addEventListener(\"mouseup\", (e) => {\n            const rect = this.canvas.getBoundingClientRect();\n            this.screen.handleMouseUp(e.clientX - rect.left, e.clientY - rect.top);\n        });\n\n        this.canvas.addEventListener(\"mouseleave\", (e) => {\n            this.screen.handleMouseLeave();\n        });\n\n        document.addEventListener(\"keydown\", (e) => {\n            e.preventDefault();\n            this.screen.handleKeyDown(e.code);\n        });\n\n        document.addEventListener(\"keyup\", (e) => {\n            e.preventDefault();\n            this.screen.handleKeyUp(e.code);\n        });\n\n        /*this.loadAssets().then(() => {\n\n            this.canvas.addEventListener(\"click\", (e) => {\n                console.log(e);\n            });\n\n            this.loadDemo();\n        });*/\n    }\n\n    /*loadAssets() {\n        let loadingPromise = new Promise((resolve, reject) => {\n            resolve();\n        });\n        return loadingPromise\n    }*/\n}\n\n\n// WEBPACK FOOTER //\n// ./js/Game.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../node_modules/css-loader/index.js!./main.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../node_modules/css-loader/index.js!./main.css\", function() {\n\t\t\tvar newContent = require(\"!!../node_modules/css-loader/index.js!./main.css\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./css/main.css\n// module id = 3\n// module chunks = 0","import { Vector } from './Vector';\n\nclass BSPTree {\n    \n    constructor(faces) {\n        this.nodes = [];\n        this.front = null;\n        this.back = null;\n        if (faces.length == 0) {\n            return;\n        }\n\n        this.nodes = [faces[0]];\n        const p0 = faces[0].getPoints()[0];\n        const n = faces[0].getNormal();\n        const frontFaces = [];\n        const backFaces = [];\n\n        for (let i = 1; i < faces.length; i++) {\n            let pos;\n            let cut = false;\n            const frontPoints = [];\n            const backPoints = [];\n            const points = faces[i].getPoints();\n\n            //Get initial pos\n            const lastD = Vector.createFromPoints(p0, points[points.length - 1]).dot(n);\n            if (Math.abs(lastD) < 0.001) {\n                pos = null;\n            } else if (lastD > 0) {\n                pos = 'front';\n            } else {\n                pos = 'back';\n            }\n\n            // Iterate over points\n            for (let j = 0; j < points.length; j++) {\n                const p = points[j];\n                const d = Vector.createFromPoints(p0, p).dot(n);\n                if (Math.abs(d) < 0.001) {\n                    pos = null;\n                    frontPoints.push(p);\n                    backPoints.push(p);\n                } else if (d > 0) {\n                    if (pos === 'back') {\n                        const prevP = j === 0 ? points[points.length - 1] : points[j - 1];\n                        const prevD = Vector.createFromPoints(p0, prevP).dot(n);\n                        const mid = p.midpoint(prevP, d / (d - prevD));\n                        frontPoints.push(mid);\n                        backPoints.push(mid);\n                        cut = true;\n                    }\n                    frontPoints.push(p);\n                    pos = 'front';\n                } else {\n                    if (pos === 'front') {\n                        const prevP = j === 0 ? points[points.length - 1] : points[j - 1];\n                        const prevD = Vector.createFromPoints(p0, prevP).dot(n);\n                        const mid = p.midpoint(prevP, d / (d - prevD));\n                        frontPoints.push(mid);\n                        backPoints.push(mid);\n                        cut = true;\n                    }\n                    backPoints.push(p);\n                    pos = 'back';\n                }\n            }\n\n            if (cut) {\n                // Split a face...\n                const { face1, face2 } = faces[i].getPolygon().splitFace(faces[i], frontPoints, backPoints);\n                frontFaces.push(face1);\n                backFaces.push(face2);\n            } else {\n                if (frontPoints.length === points.length && backPoints.length === points.length) {\n                    this.nodes.push(faces[i]);\n                } else if (frontPoints.length === points.length) {\n                    frontFaces.push(faces[i]);\n                } else {\n                    backFaces.push(faces[i]);\n                }\n            }\n        }\n\n        if (frontFaces.length > 0) {\n            this.front = new BSPTree(frontFaces);\n        }\n        if (backFaces.length > 0) {\n            this.back = new BSPTree(backFaces);\n        }\n    }\n\n    addFace(face) {\n        if (this.nodes.length === 0) {\n            this.nodes = [face];\n            return;\n        }\n        const p0 = this.nodes[0].getPoints()[0];\n        const n = this.nodes[0].getNormal();\n        let pos;\n        let cut = false;\n        const frontPoints = [];\n        const backPoints = [];\n        const points = face.getPoints();\n\n        //Get initial pos\n        const lastD = Vector.createFromPoints(p0, points[points.length - 1]).dot(n);\n        if (Math.abs(lastD) < 0.001) {\n            pos = null;\n        } else if (lastD > 0) {\n            pos = 'front';\n        } else {\n            pos = 'back';\n        }\n\n        // Iterate over points\n        for (let j = 0; j < points.length; j++) {\n            const p = points[j];\n            const d = Vector.createFromPoints(p0, p).dot(n);\n            if (Math.abs(d) < 0.001) {\n                pos = null;\n                frontPoints.push(p);\n                backPoints.push(p);\n            } else if (d > 0) {\n                if (pos === 'back') {\n                    const prevP = j === 0 ? points[points.length - 1] : points[j - 1];\n                    const prevD = Vector.createFromPoints(p0, prevP).dot(n);\n                    const mid = p.midpoint(prevP, d / (d - prevD));\n                    frontPoints.push(mid);\n                    backPoints.push(mid);\n                    cut = true;\n                }\n                frontPoints.push(p);\n                pos = 'front';\n            } else {\n                if (pos === 'front') {\n                    const prevP = j === 0 ? points[points.length - 1] : points[j - 1];\n                    const prevD = Vector.createFromPoints(p0, prevP).dot(n);\n                    const mid = p.midpoint(prevP, d / (d - prevD));\n                    frontPoints.push(mid);\n                    backPoints.push(mid);\n                    cut = true;\n                }\n                backPoints.push(p);\n                pos = 'back';\n            }\n        }\n\n        if (cut) {\n            // Split a face...\n            const { face1, face2 } = face.getPolygon().splitFace(face, frontPoints, backPoints);\n            if (this.front !== null) {\n                this.front.addFace(face1);\n            } else {\n                this.front = new BSPTree([face1]);\n            }\n            if (this.back !== null) {\n                this.back.addFace(face2);\n            } else {\n                this.back = new BSPTree([face2]);\n            }\n        } else {\n            if (frontPoints.length === points.length && backPoints.length === points.length) {\n                this.nodes.push(face);\n            } else if (frontPoints.length === points.length) {\n                if (this.front !== null) {\n                    this.front.addFace(face);\n                } else {\n                    this.front = new BSPTree([face]);\n                }\n            } else {\n                if (this.back !== null) {\n                    this.back.addFace(face);\n                } else {\n                    this.back = new BSPTree([face]);\n                }\n            }\n        }\n    }\n\n    addFaces(faces) {\n        faces.forEach(face => this.addFace(face));\n    }\n\n    removeFace(face) {\n        const idx = this.nodes.indexOf(face);\n        if (idx !== -1) {\n            this.nodes.splice(idx, 1);\n            return;\n        }\n        if (this.front !== null) {\n            this.front.removeFace(face);\n        }\n        if (this.back !== null) {\n            this.back.removeFace(face);\n        }\n    }\n\n    removeFaces(faces) {\n        faces.forEach(face => this.removeFace(face));\n    }\n\n    traverse(fn, viewport) {\n        if (this.nodes.length > 0) {\n            const n = this.nodes[0].getNormal();\n            const p = this.nodes[0].getPoints()[0];\n            const viewDir = viewport.getViewDir(p, n);\n            if (viewDir === 'towards') {\n                if (this.back !== null) {\n                    this.back.traverse(fn, viewport);\n                }\n                for (let i = 0; i < this.nodes.length; i++) {\n                    fn(this.nodes[i]);\n                }\n                if (this.front !== null) {\n                    this.front.traverse(fn, viewport);\n                }\n            } else {\n                if (this.front !== null) {\n                    this.front.traverse(fn, viewport);\n                }\n                for (let i = 0; i < this.nodes.length; i++) {\n                    fn(this.nodes[i]);\n                }\n                if (this.back !== null) {\n                    this.back.traverse(fn, viewport);\n                }\n                \n            }\n        }\n    }\n}\n\nexport { BSPTree };\n\n\n// WEBPACK FOOTER //\n// ./js/BSPTree.js","import { deserialize } from \"./MapSerializer\";\n\nvar exampleMapString = \n`p-1 p-2 p-3\np-2 p-3 p-2\np-3 p-1 p-1\np-1 e-1 p-1\np-1 p-1 p-1\n===\nw-0-0-0\nw-1-0-0\nw-2-0-1\n===\n0\n0-1\n1-1-1`;\n/*\nvar exampleMapString = \n`p-1\np-3\n===\nk-0-0-0-20`;*/\n\nconst defaultMap = deserialize(exampleMapString);\n\nexport default defaultMap;\n\n\n// WEBPACK FOOTER //\n// ./js/DefaultMap.js","import { serialize } from \"./MapSerializer\";\n\nclass Map {\n\n    constructor(tiles, objective, turnPlayers, actions) {\n        this.tiles = tiles\n        this.objective = objective;\n        this.turnPlayers = turnPlayers;\n        this.turnPlayer = turnPlayers[0];\n        this.turnPlayerIdx = 0;\n        this.actions = actions;\n        this.listeners = [];\n    }\n\n    getTiles() {\n        return this.tiles;\n    }\n\n    getTilesFlattened() {\n        let flattenedArray = [];\n        this.tiles.forEach((row) => {\n            flattenedArray = flattenedArray.concat(row);\n        });\n        return flattenedArray;\n    }\n\n    getMapObjects() {\n        return this.getTilesFlattened().map(t => t.getMapObject()).filter(m => m !== null);\n    }\n\n    getObjective() {\n        return this.objective;\n    }\n\n    serializeTurnPlayers() {\n        let ret = '';\n        let idx = this.turnPlayerIdx;\n        for (let i = 0; i < this.turnPlayers.length; i++) {\n            ret += this.turnPlayers[idx];\n            if (i !== this.turnPlayers.length - 1) {\n                ret += '-';\n            }\n            idx = (idx + 1) % this.turnPlayers.length;\n        }\n        return ret;\n    }\n\n    static deserializeTurnPlayers(str) {\n        return str.split('-');\n    }\n\n    getTurnPlayer() {\n        return this.turnPlayer;\n    }\n\n    serializeActions() {\n        return `${this.actions.move}-${this.actions.transfer}-${this.actions.attack}`;\n    }\n\n    static deserializeActions(str) {\n        const s = str.split('-');\n        return {\n            move: parseInt(s[0]),\n            transfer: parseInt(s[1]),\n            attack: parseInt(s[2]),\n        };\n    }\n\n    isResolved() {\n        return this.objective.check(this);\n    }\n\n    serialize() {\n        return serialize(this);\n    }\n\n    /*\n       Actions:\n        move/attack\n        transfer\n    */\n    doAction(name, sx, sy, dx, dy) {\n        if (this.actions[name] > 0) {\n            const srcTile = this.tiles[sy][sx];\n            const obj = srcTile.getMapObject();\n            const dstTile = this.tiles[dy][dx]; \n            const e = obj[name](dstTile, this.turnPlayer);\n            this.actions[name] -= 1;\n\n            this.listeners.forEach(l => l.trigger(e));\n        } else if (name !== 'end') {\n            throw Error('Invalid action');\n        }\n        if (name === 'end' || Object.values(this.actions).reduce((a,b) => a + b, 0) === 0) {\n            this.turnPlayerIdx = (this.turnPlayerIdx + 1) % this.turnPlayers.length;\n            this.turnPlayer = this.turnPlayers[this.turnPlayerIdx];\n            this.actions = {\n                move: 1,\n                transfer: 1,\n                attack: 1,\n            };\n        }\n    }\n\n    addListener(l) {\n        this.listeners.push(l);\n    }\n    /*\n\n    applyAction(actor, action, receiver) {\n        if (action === 'move') {\n            actor.moveTo(receiver);\n        }\n    }\n\n    clicked(obj) {\n        if (obj instanceof MapObject) {\n            //this.setSelection(obj);\n            //rerender = true;\n        } else if (obj instanceof Tile) {\n            if (obj.isHighlighted()) {\n                this.turnActor.moveTo(obj);\n            }\n        }\n    }\n\n    serialize() {\n        const serializer = new MapSerializer();\n        return serializer.serialize(this);\n    }\n\n    /*nextTurn() {\n        if (this.turnActor !== null) {\n            this.turnQueue.pop();\n            this.turnActor.subtractTicks(this.TICK_THRESHOLD);\n        }\n        while (this.turnQueue.length === 0) {\n            for (let i = 0; i < this.actors.length; i++) {\n                this.actors[i].tickForward();\n                const ticks = this.actors[i].getTicks();\n                if (ticks > this.TICK_THRESHOLD) {\n                    let idx = this.turnQueue.length;\n                    for (let j = 0; j < this.turnQueue.length; j++) {\n                        if (this.turnQueue[j][1] > ticks) {\n                            idx = j;\n                            break;\n                        }\n                    }\n                    this.turnQueue.splice(idx, 0, [this.actors[i], ticks]);\n                }\n            }\n        }\n        this.turnActor = this.turnQueue[this.turnQueue.length - 1][0];\n        return this.turnActor;\n    }*/\n\n    /*getTurnActor() {\n        return this.turnActor;\n    }\n\n    getPlayerOptions() {\n        return this.playerOptions;\n    }\n\n    setPlayerOptions(options) {\n        this.playerOptions = options;\n    }*/\n}\n\nexport { Map }\n\n\n// WEBPACK FOOTER //\n// ./js/Map.js","class MapObject {\n\n    constructor(props, tile = null) {\n        this.tile = tile;\n        if (tile !== null) {\n            tile.setMapObject(this);\n        }\n    }\n\n    getTile() {\n        return this.tile;\n    }\n\n    getX() {\n        return this.tile.getX();\n    }\n\n    getY() {\n        return this.tile.getY();\n    }\n\n    getH() {\n        return this.tile.getH();\n    }\n\n    serialize() {\n        return `${this.constructor.name()}-${this.getX()}-${this.getY()}`;\n    }\n\n    static deserialize(props, tiles) {\n        const p = props.split('-');\n        const cls = NAME_MAP[p[0]];\n        const x = parseInt(p[1]);\n        const y = parseInt(p[2]);\n        return new cls(p.slice(3, p.length), tiles[y][x]);\n    }\n\n    setReferences(tiles, mapObjects) {\n        this.tile = tiles[this.y][this.x];\n        this.tile.setMapObject(this);\n    }\n\n    getActions() {\n        return [];\n    }\n\n    getPlayer() {\n        return null;\n    }\n\n    moveable() {\n        return false;\n    }\n}\n\nclass Shard extends MapObject {\n\n    moveable() {\n        return true;\n    }\n\n    attackedBy() {\n        this.tile.unsetMapObject();\n    }\n}\n\nclass BlueShard extends Shard {\n\n    static name() {\n        return 'bs';\n    }\n}\n\nclass RedShard extends Shard {\n    static name() {\n        return 'rs';\n    }\n}\n\nclass YellowShard extends Shard {\n    static name() {\n        return 'ys';\n    }\n}\n\n\nclass Vessel extends MapObject {\n\n    constructor(props, tile) {\n        super(...arguments);\n        this.player = props[0];\n        this.movement = 4;\n        this.range = 1;\n    }\n\n\n    serialize() {\n        return `${super.serialize()}-${this.player}`\n    }\n\n    transfer(tile, player) {\n        if (player !== this.player) {\n            throw Error('Invalid action: wrong player');\n        }\n        const mO = tile.getMapObject();\n        if (mO !== null && mO.getPlayer() === this.player && this.getShard() !== null) {\n            const cls = mO.consumeShard(this.getShard());\n            new cls([mO.getPlayer()], tile);\n            new WhiteVessel([this.player], this.tile);\n        } else {\n            throw Error('Invalid transfer tile');\n        }\n    }\n\n    attack(tile, player) {\n        if (player !== this.player) {\n            throw Error('Invalid action: wrong player');\n        }\n        if (!this.tile.getNeighbors(this.range).has(tile)) {\n            throw Error('Invalid action: cannot reach tile');\n        }\n\n        const mO = tile.getMapObject();\n        if (mO !== null) {\n            mO.attackedBy(this);\n        } else {\n            throw Error('Invalid attack tile');\n        }\n    }\n\n    move(tile, player) {\n        if (player !== this.player) {\n            throw Error('Invalid action: wrong player');\n        }\n\n        const paths = this.tile.getPaths(this.movement);\n        const key = `${tile.getX()}-${tile.getY()}`;\n        if (paths[key] === undefined) {\n            throw Error('Invalid action: cannot reach tile');\n        }\n\n        const mO = tile.getMapObject();\n        if (mO === null) {\n            this.tile.unsetMapObject();\n            tile.setMapObject(this);\n            this.tile = tile;\n            return {\n                name: 'move',\n                path: paths[key],\n            };\n        } else if (mO instanceof Shard) {\n            const cls = this.consumeShard(mO);\n            new cls([this.player], tile);\n            this.tile.unsetMapObject();\n            return {\n                name: 'move',\n            };\n        }\n        throw Error('Invalid move tile');\n    }\n\n    getPlayer() {\n        return this.player;\n    }\n\n    getShard() {\n        return null;\n    }\n\n    attackedBy() {\n        this.tile.unsetMapObject();\n    }\n}\n\nclass WhiteVessel extends Vessel {\n\n    consumeShard(shard) {\n        if (shard instanceof BlueShard) {\n            return BlueVessel;\n        } else if (shard instanceof RedShard) {\n            return RedVessel;\n        } else if (shard instanceof YellowShard) {\n            return YellowVessel;\n        }\n    }\n\n    static name() {\n        return 'w';\n    }\n}\n\nclass BlueVessel extends Vessel {\n\n    static name() {\n        return 'b';\n    }\n\n    getShard() {\n        return new BlueShard();\n    }\n}\n\nclass RedVessel extends Vessel {\n\n    static name() {\n        return 'r';\n    }\n\n    getShard() {\n        return new RedShard();\n    }\n}\n\nclass YellowVessel extends Vessel {\n\n    constructor() {\n        super(...arguments);\n        this.movement = 5;\n    }\n\n    static name() {\n        return 'y';\n    }\n\n    getShard() {\n        return new YellowShard();\n    }\n}\n\nconst NAME_MAP = {\n    bs: BlueShard,\n    rs: RedShard,\n    ys: YellowShard,\n    w: WhiteVessel,\n    b: BlueVessel,\n    r: RedVessel,\n    y: YellowVessel,\n}\n\nexport { MapObject }\n\n\n// WEBPACK FOOTER //\n// ./js/MapObject.js","import { Point, Vector } from \"./Vector\";\nimport { Viewport } from \"./Viewport\";\nimport { Polygon } from \"./Polygon\";\nimport { PolygonRenderer} from \"./PolygonRenderer\";\n\nconst TLEN = 100;\n\nclass MapScreen {\n\n    constructor(canvas, map) {\n        this.canvas = canvas;\n        this.map = map;\n        this.viewport = new Viewport(\n            new Point(0, 0, 500),\n            new Point(this.canvas.width, 0, 500),\n            new Point(0, this.canvas.height, 500),\n            new Point(this.canvas.width, this.canvas.height, 500),\n            500\n        );\n        this.pressed = {};\n\n        this.r = new Vector(0, 0, 1);\n        const tilePolygons = this.map.getTilesFlattened().filter(t => t.constructor.name() !== 'e').map(t => Polygon.createBox(t.getX() * TLEN, t.getY() * TLEN, 0, TLEN, TLEN, t.getH() *TLEN));\n        this.objPolygons = this.map.getMapObjects().reduce((a, m) => {\n            const p = Polygon.createIcosahedron(m.getX() * TLEN + TLEN / 2, m.getY() * TLEN + TLEN / 2, m.getH() * TLEN + TLEN / 2, 20);\n            m.getPlayer() === '0' ? p.setColor('#FFFFFF', '#E6E6E6') : p.setColor('#e6e6e6', '#ffffff');\n            a[`${m.getX()}-${m.getY()}`] = p;\n            return a;\n        }, {});\n\n        this.renderer = new PolygonRenderer(this.canvas, tilePolygons, (a,b) => a.getNormal().getZ() - b.getNormal().getZ());\n        map.addListener(this);\n    }\n\n    start() {\n        this.renderLoop();\n    }\n\n    renderLoop() {\n        this.viewport.updatePosition();\n        this.r.rotate(new Vector(1, 0, 0), 1 * Math.PI / 180);\n        const objs = Object.values(this.objPolygons);\n        objs.forEach(obj => {\n            obj.rotate(this.r, 1 * Math.PI / 180);\n            obj.updatePosition();\n        });\n        this.renderer.render(this.viewport, objs);\n        window.requestAnimationFrame((step) => {\n            this.renderLoop();\n        });\n    }\n\n    trigger(e) {\n        if (e.name === 'move') {\n            const obj = this.objPolygons[e.path[0]];\n            const tiles = this.map.getTiles();\n            const animations = e.path.slice(1, e.path.length).map(p => {\n                const x = parseInt(p.split('-')[0]);\n                const y = parseInt(p.split('-')[1]);\n                const t = tiles[y][x];\n                return {\n                    rate: null,\n                    dx: t.getX() * TLEN + TLEN / 2,\n                    dy: t.getY() * TLEN + TLEN / 2,\n                    dz: t.getH() * TLEN + TLEN / 2,\n                    frames: 30,\n                };\n            });\n            obj.queueAnimations(animations);\n        }\n    }\n\n    /*turnLoop() {\n        if (this.map.isResolved()) {\n            // End\n        } else {\n            const turnActor = this.map.nextTurn();\n            this.animateNextTurn(turnActor).then(() => {\n                turnActor.takeTurn().then(() => {\n                    this.turnLoop();\n                });\n                //this.mapRenderer.renderMap(this.map, this.viewport);\n            });\n        }\n    }*/\n\n    animateNextTurn(turnActor) {\n        return this.mapRenderer.centerOn(turnActor);\n        //return new Promise((resolve, reject) => {\n        //    resolve();\n            //return this.mapRenderer.centerOn(turnActor);\n        //});\n    }\n\n    handleMouseDown(x, y) {\n        //this.startDragX = x;\n        //this.startDragY = y;\n    }\n\n    handleMouseMove(x, y) {\n        this.viewport.setMouse(x,y);\n        /*if (this.startDragX !== null && this.startDragY !== null) {\n            const dx = this.startDragX - x;\n            const dy = this.startDragY - y;\n            this.viewport.translateAlongBasis(dx, dy);\n            this.startDragX = x;\n            this.startDragY = y;\n        }*/\n        //this.mapRenderer.renderMap();\n    }\n\n    handleMouseUp(x, y) {\n        //this.startDragX = null;\n        //this.startDragY = null;\n    }\n\n    handleClick(x, y) {\n        //this.viewport.mx = this.viewport.x1 + x;\n        //this.viewport.my = this.viewport.y1 + y;\n        /*const clickedObj = this.mapRenderer.getClickedObject();\n        if (clickedObj instanceof Tile) {\n            const action = this.map.getSelectedAction(clickedObj);\n            if (action !== null && action.action === 'move') {\n                this.mapRenderer.animateMove(action.actor, action.receiver).then(() => {\n                    this.map.applyAction(action.actor, action.action, action.receiver);\n                });\n            }\n        } else if (clickedObj instanceof ActorAction) {\n            this.map.getTurnActor().handleAction(clickedObj);\n        }*/\n        //const clickedObjs = this.mapRenderer.getClickedObjects();\n\n        //const rerender = this.map.clicked(clickedObjs);\n        //if (rerender) {\n            //this.mapRenderer.renderMap(this.map, this.viewport);\n        //}\n    }\n\n    handleMouseLeave() {\n        this.viewport.setMouse(null, null);\n        //this.startDragX = null;\n        //this.startDragY = null;\n        //this.mapRenderer.renderMap(this.map, this.viewport);\n    }\n\n    handleKeyDown(code) {\n        if (!this.pressed[code]) {\n            this.pressed[code] = true;\n            const updateRates = {};\n            switch (code) {\n                case 'KeyA':\n                    updateRates.t1 = -20;\n                    break;\n                case 'KeyW':\n                    updateRates.t3 = 20;\n                    break;\n                case 'KeyD':\n                    updateRates.t1 = 20;\n                    break;\n                case 'KeyS':\n                    updateRates.t3 = -20;\n                    break;\n                case 'Space':\n                    updateRates.t2 = -20;\n                    break;\n                case 'ShiftLeft':\n                    updateRates.t2 = 20;\n                    break;\n                case 'ArrowUp':\n                    updateRates.r1 = -3;\n                    break;\n                case 'ArrowDown':\n                    updateRates.r1 = 3;\n                    break;\n                case 'ArrowLeft':\n                    updateRates.r2 = 3;\n                    break;\n                case 'ArrowRight':\n                    updateRates.r2 = -3;\n                    break;\n            }\n            this.viewport.updateRates(updateRates);\n        }\n    }\n\n    handleKeyUp(code) {\n        if (this.pressed[code]) {\n            this.pressed[code] = false;\n            const updateRates = {};\n            switch (code) {\n                case 'KeyA':\n                    updateRates.t1 = 20;\n                    break;\n                case 'KeyW':\n                    updateRates.t3 = -20;\n                    break;\n                case 'KeyD':\n                    updateRates.t1 = -20;\n                    break;\n                case 'KeyS':\n                    updateRates.t3 = 20;\n                    break;\n                case 'Space':\n                    updateRates.t2 = 20;\n                    break;\n                case 'ShiftLeft':\n                    updateRates.t2 = -20;\n                    break;\n                case 'ArrowUp':\n                    updateRates.r1 = 3;\n                    break;\n                case 'ArrowDown':\n                    updateRates.r1 = -3;\n                    break;\n                case 'ArrowLeft':\n                    updateRates.r2 = -3;\n                    break;\n                case 'ArrowRight':\n                    updateRates.r2 = 3;\n                    break;\n            }\n            this.viewport.updateRates(updateRates);\n        }\n    }\n}\n\nexport { MapScreen }\n\n\n// WEBPACK FOOTER //\n// ./js/MapScreen.js","class Objective {\n\n    constructor(fn, num) {\n        this.fn = fn;\n        this.num = num;\n    }\n\n    serialize() {\n        return this.num;\n    }\n\n    static deserialize(num) {\n        return new Objective(OBJECT_FNS[num], num);\n    }\n\n    check(map) {\n        return this.fn.check(map);\n    }\n\n    success(map) {\n        return this.fn.success(map);\n    }\n\n}\n\nconst OBJECT_FNS = {\n    0: {\n        check: map => {\n            let players = map.getMapObjects().map(m => m.getPlayer()).filter(p => p !== null);\n            let player = players.filter(p => p === '0');\n            let enemies =  players.filter(p => p !== '0');\n            return player.length === 0 || enemies.length === 0;\n        },\n        success: map => {\n            let players = map.getMapObjects().map(m => m.getPlayer());\n            let enemies =  players.filter(p => p !== '0' && p !== null);\n            return enemies.length === 0;\n        }\n    },\n}\n\nexport { Objective }\n\n\n// WEBPACK FOOTER //\n// ./js/Objective.js","import { Point, Vector } from \"./Vector\";\n\nclass Polygon {\n    constructor(faces, type) {\n        this.faces = faces;\n        faces.forEach(face => face.setPolygon(this));\n        this.type = type;\n        this.clippedFace = null;\n        this.hover = false;\n        this.originalFaces = faces.slice();\n        this.color = \"#CCCCCC\";\n        this.highlightColor = \"#E6E6E6\";\n        this.animations = [];\n    }\n\n    translate(x, y, z) {\n        const points = Array.from(new Set(this.faces.reduce((a,b) => a.concat(b.getPoints()), [])));\n        points.forEach(point => point.translate(x, y, z));\n    }\n\n    rotate(v, rad) {\n        const points = Array.from(new Set(this.faces.reduce((a,b) => a.concat(b.getPoints()), [])));\n        const x = points.reduce((a,b) => a + b.getX(), 0) / points.length;\n        const y = points.reduce((a,b) => a + b.getY(), 0) / points.length;\n        const z = points.reduce((a,b) => a + b.getZ(), 0) / points.length;\n        points.forEach(point => {\n            point.translate(-x, -y, -z);\n            point.rotate(v, rad);\n            point.translate(x, y, z);\n        });\n        this.faces.forEach(face => {\n            face.getNormal().rotate(v, rad);\n        });\n    }\n\n    getColor(face) {\n        return this.hover ? this.highlightColor : this.color;\n    }\n\n    setColor(color, highlightColor) {\n        this.color = color;\n        this.highlightColor = highlightColor;\n    }\n\n    queueAnimations(animations) {\n        this.animations = this.animations.concat(animations);\n    }\n\n    updatePosition() {\n        if (this.animations.length > 0) {\n            const animation = this.animations[0];\n            if (animation.rate === null){\n                const points = Array.from(new Set(this.faces.reduce((a,b) => a.concat(b.getPoints()), [])));\n                const sx = points.reduce((a,b) => a + b.getX(), 0) / points.length;\n                const sy = points.reduce((a,b) => a + b.getY(), 0) / points.length;\n                const sz = points.reduce((a,b) => a + b.getZ(), 0) / points.length;\n                animation.rate = {\n                    x: (animation.dx - sx) / animation.frames,\n                    y: (animation.dy - sy) / animation.frames,\n                    z: (animation.dz - sz) / animation.frames,\n                };\n            }\n            this.translate(animation.rate.x, animation.rate.y, animation.rate.z);\n            animation.frames -= 1;\n            if (animation.frames === 0) {\n                this.animations.splice(0, 1);\n            }\n        }\n    }\n\n    toggleHover() {\n        this.hover = !this.hover;\n    }\n\n    getFaces() {\n        return this.faces;\n    }\n\n    restoreFaces() {\n        this.faces = this.originalFaces.slice();\n    }\n\n    getClippedFace() {\n        return this.clippedFace;\n    }\n\n    calcClippedFace() {\n        let newFacePoints = null;\n        this.faces.forEach(face => {\n            const clippedPoints = face.getClippedPoints();\n            if (clippedPoints.length > 0) {\n                if (newFacePoints === null) {\n                    newFacePoints = clippedPoints.slice();\n                } else {\n                    for (let i = 0; i < clippedPoints.length; i++) {\n                        const c = clippedPoints[i];\n                        let minDist = null;\n                        let minDistIdx = null;\n                        let match = false;\n                        for (let j = 0; j < newFacePoints.length; j++) {\n                            const cp = newFacePoints[j];\n                            const nextcp = j == newFacePoints.length - 1 ? newFacePoints[0] : newFacePoints[j + 1];\n                            const currDist = Vector.createFromPoints(cp, nextcp).getMag();\n                            const cDist1 = Vector.createFromPoints(cp, c).getMag();\n                            const cDist2 = Vector.createFromPoints(nextcp, c).getMag();\n                            const distInc = cDist1 + cDist2 - currDist;\n                            if (distInc === 0) {\n                                match = true;\n                                break;\n                            }\n                            if (minDist == null || distInc < minDist) {\n                                minDist = distInc;\n                                minDistIdx = j;\n                            }\n                        }\n                        if (!match) {\n                            if (minDistIdx == newFacePoints.length - 1) {\n                                newFacePoints.splice(0, 0, c);\n                            } else {\n                                newFacePoints.splice(minDistIdx + 1, 0, c);\n                            }\n                        }\n                    }\n\n                }\n            }\n        });\n        if (newFacePoints !== null) {\n            this.clippedFace = new PolygonFace();\n            this.clippedFace.setVisiblePoints(newFacePoints, []);\n            this.clippedFace.setPolygon(this);\n        } else {\n            this.clippedFace = null;\n        }\n    }\n\n    splitFace(face, points1, points2) {\n        this.faces.splice(this.faces.indexOf(face), 1);\n        const blacklist = face.getEdgeBlacklist();\n        const sharedPoints = points1.filter(p => points2.indexOf(p) !== -1);\n        const n = face.getNormal();\n\n        const [face1, face2] = [points1, points2].map(points => {\n            const f = new PolygonFace(points, n);\n            f.setPolygon(this);\n            const newBlacklist = [sharedPoints];\n            blacklist.forEach(b => {\n                const idx1 = points.indexOf(b[0]);\n                const idx2 = points.indexOf(b[1]);\n                if (idx1 !== -1 && idx2 !== -1) {\n                    newBlacklist.push(b);\n                } else if (idx1 !== -1 || idx2 !== -1) {\n                    const idx = idx1 !== -1 ? idx1 : idx2;\n                    const nidx = idx === points.length - 1 ? 0 : idx + 1;\n                    const pidx = idx === 0 ? points.length - 1 : idx - 1;\n                    const p = points[idx];\n                    const np = points[nidx];\n                    const pp = points[pidx];\n                    if (sharedPoints.indexOf(np) === -1) {\n                        newBlacklist.push([p, pp]);\n                    } else if (sharedPoints.indexOf(pp) === -1) {\n                        newBlacklist.push([p, np]);\n                    } else {\n                        // You've got a triangle\n                        const v1 = Vector.createFromPoints(b[0], b[1]);\n                        v1.normalize();\n                        const v2 = Vector.createFromPoints(p, np);\n                        v2.normalize();\n                        if (Math.abs(Math.abs(v1.dot(v2)) - 1) < 0.001) {\n                            newBlacklist.push([p, np]);\n                        } else {\n                            newBlacklist.push([p, pp]);\n                        }\n                    }\n                }\n            });\n            f.setEdgeBlacklist(newBlacklist);\n            this.faces.push(f);\n            return f;\n        });\n\n        return {\n            face1,\n            face2\n        };\n    }\n\n    static createBox(x, y, z, w, l, h) {\n        const v = [\n            new Point(x, y, z + h),\n            new Point(x + w, y, z + h),\n            new Point(x + w, y + l, z + h),\n            new Point(x , y + l, z + h),\n            new Point(x, y, z),\n            new Point(x + w, y, z),\n            new Point(x + w, y + l, z),\n            new Point(x, y + l, z),\n        ];\n        const faces = [\n            new PolygonFace([v[0], v[1], v[2], v[3]], new Vector(0, 0, 1)),\n            new PolygonFace([v[1], v[2], v[6], v[5]], new Vector(1, 0, 0)),\n            new PolygonFace([v[4], v[5], v[6], v[7]], new Vector(0, 0, -1)),\n            new PolygonFace([v[0], v[1], v[5], v[4]], new Vector(0, -1, 0)),\n            new PolygonFace([v[0], v[3], v[7], v[4]], new Vector(-1, 0, 0)),\n            new PolygonFace([v[2], v[3], v[7], v[6]], new Vector(0, 1, 0))\n        ];\n\n        return new Polygon(faces, 'box');\n    }\n\n    static createIcosahedron(x, y, z, scale) {\n        const t = (1 + Math.sqrt(5)) / 2;\n        const v = [\n            new Point(-1, t, 0),\n            new Point(1, t, 0),\n            new Point(-1, -t, 0),\n            new Point(1, -t, 0),\n            new Point(0, -1, t),\n            new Point(0, 1, t),\n            new Point(0, -1, -t),\n            new Point(0, 1, -t),\n            new Point(t, 0, -1),\n            new Point(t, 0, 1),\n            new Point(-t, 0, -1),\n            new Point(-t, 0, 1)\n        ];\n\n        const faces = [\n        [0, 11, 5],\n        [0, 5, 1],\n        [0, 1, 7],\n        [0, 7, 10],\n        [0, 10, 11],\n\n        [1, 5, 9],\n        [5, 11, 4],\n        [11, 10, 2],\n        [10, 7, 6],\n        [7, 1, 8],\n\n        [3, 9, 4],\n        [3, 4, 2],\n        [3, 2, 6],\n        [3, 6, 8],\n        [3, 8, 9],\n\n        [4, 9, 5],\n        [2, 4, 11],\n        [6, 2, 10],\n        [8, 6, 7],\n        [9, 8, 1]\n        ].map(idx => {\n            const p1 = v[idx[0]];\n            const p2 = v[idx[1]];\n            const p3 = v[idx[2]];\n            const v1 = Vector.createFromPoints(p1, p2);\n            const v2 = Vector.createFromPoints(p1, p3);\n            const n = v1.cross(v2);\n            n.normalize();\n            return new PolygonFace([p1, p2, p3], n);\n        });\n\n        v.forEach(v => {\n            v.scale(scale);\n            v.translate(x, y, z);\n        });\n\n        return new Polygon(faces, 'icosahedron');\n    }\n}\n\nclass PolygonFace {\n    constructor(points, unitNormal) {\n        this.points = points;\n        this.normal = unitNormal;\n        this.polygon = null;\n        this.visiblePoints = [];\n        this.mapping = [];\n        this.edgeBlacklist = [];\n    }\n\n    translate(x, y, z) {\n        this.points.forEach(p => p.translate(x, y, z));\n    }\n\n    rotate(v, rad) {\n        this.points.forEach(p => p.rotate(v, rad));\n        this.normal.rotate(v, rad);\n    }\n\n    getPoints() {\n        return this.points;\n    }\n\n    getNormal() {\n        return this.normal;\n    }\n\n    getPolygon() {\n        return this.polygon;\n    }\n\n    setPolygon(polygon) {\n        this.polygon = polygon;\n    }\n\n    getClippedPoints() {\n        const clippedPoints = [];\n        for (let i = 0; i < this.mapping.length; i++) {\n            if (typeof this.mapping[i] !== 'number') {\n                clippedPoints.push(this.visiblePoints[i]);\n            }\n        }\n        return clippedPoints;\n    }\n\n    getVisiblePoints() {\n        return this.visiblePoints;\n    }\n\n    setVisiblePoints(points, mapping) {\n        this.visiblePoints = points;\n        this.mapping = mapping;\n    }\n\n    getEdgeBlacklist() {\n        return this.edgeBlacklist;\n    }\n\n    setEdgeBlacklist(blacklist) {\n        this.edgeBlacklist = blacklist;\n    }\n\n    draw(ctx) {\n        ctx.fillStyle = this.polygon.getColor(this);\n        ctx.beginPath();\n        let k;\n        for (k = 0; k < this.visiblePoints.length; k++) {\n            if (k == 0) {\n                ctx.moveTo(this.visiblePoints[k].getX(), this.visiblePoints[k].getY());\n            }\n            if (k == this.visiblePoints.length - 1) {\n                ctx.lineTo(this.visiblePoints[0].getX(), this.visiblePoints[0].getY());\n            } else {\n                ctx.lineTo(this.visiblePoints[k + 1].getX(), this.visiblePoints[k + 1].getY());\n            }\n        }\n        ctx.fill();\n\n        let nextK;\n        let edge;\n        let blacklist;\n        ctx.strokeStyle = \"#000000\";\n        //Draw outline\n        for (k = 0; k < this.visiblePoints.length; k++) {\n            nextK = k === this.visiblePoints.length - 1 ? 0 : k + 1;\n            edge = null;\n            blacklist = false;\n            if (typeof this.mapping[k] === 'number') {\n                if (typeof this.mapping[nextK] === 'number') {\n                    edge = [this.points[this.mapping[k]], this.points[this.mapping[nextK]]];\n                } else {\n                    if (this.points[this.mapping[k]] === this.points[this.mapping[nextK][0]]) {\n                        edge = [this.points[this.mapping[k]], this.points[this.mapping[nextK][1]]];\n                    } else {\n                        edge = [this.points[this.mapping[k]], this.points[this.mapping[nextK][0]]];\n                    }\n                }\n            } else if (typeof this.mapping[nextK] === 'number') {\n                if (this.points[this.mapping[k][0]] === this.points[this.mapping[nextK]]) {\n                    edge = [this.points[this.mapping[k][1]], this.points[this.mapping[nextK]]];\n                } else {\n                    edge = [this.points[this.mapping[k][0]], this.points[this.mapping[nextK]]];\n                }\n            }\n\n            if (edge !== null) {\n                blacklist = this.edgeBlacklist.filter(b => b.indexOf(edge[0]) !== -1 && b.indexOf(edge[1]) !== -1).length > 0;\n            }\n\n            if (!blacklist) {\n                ctx.beginPath();\n                ctx.moveTo(this.visiblePoints[k].getX(), this.visiblePoints[k].getY());\n                ctx.lineTo(this.visiblePoints[nextK].getX(), this.visiblePoints[nextK].getY());\n                ctx.stroke();\n            }\n        }\n    }\n}\n\nexport { Polygon, PolygonFace };\n\n\n// WEBPACK FOOTER //\n// ./js/Polygon.js","import { BSPTree } from \"./BSPTree\";\n\nclass PolygonRenderer {\n    \n    constructor(canvas, staticPolygons, faceSort = () => {}) {\n        this.canvas = canvas;\n        const staticFaces = staticPolygons.reduce((a, b) => a.concat(b.getFaces()), []);\n        staticFaces.sort(faceSort);\n        this.bsp = new BSPTree(staticFaces);\n        this.staticPolygons = staticPolygons;\n        this.hoveredPolygon = null;\n    }\n\n    render(viewport, polygons) {\n        const ctx = this.canvas.getContext('2d');\n        ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\n        const facesToDraw = [];\n        let hoveredFace = null;\n\n        this.bsp.addFaces(polygons.reduce((a, b) => a.concat(b.getFaces()), []));\n\n        this.bsp.traverse((face) => {\n            const { visiblePoints, mapping, visible} = viewport.projectFace(face);\n            face.setVisiblePoints(visiblePoints, mapping);\n            if (visible) {\n                if (viewport.mouseInside(visiblePoints)) {\n                    hoveredFace = face;\n                }\n                facesToDraw.push(face);\n            }\n        }, viewport);\n\n        this.bsp.removeFaces(polygons.reduce((a, b) => a.concat(b.getFaces()), []));\n\n        this.staticPolygons.concat(polygons).forEach(polygon => {\n            polygon.calcClippedFace();\n            const clippedFace = polygon.getClippedFace();\n            if (clippedFace !== null) {\n                if (viewport.mouseInside(clippedFace.getVisiblePoints())) {\n                    hoveredFace = clippedFace;\n                }\n                facesToDraw.push(clippedFace);\n            }\n        });\n\n        if (this.hoveredPolygon !== null) {\n            this.hoveredPolygon.toggleHover();\n        }\n        if (hoveredFace !== null) {\n            this.hoveredPolygon = hoveredFace.getPolygon();\n            this.hoveredPolygon.toggleHover();\n        } else {\n            this.hoveredPolygon = null;\n        }\n\n        facesToDraw.forEach(face => face.draw(ctx));\n\n        polygons.forEach(polygon => polygon.restoreFaces());\n    }\n}\n\nexport { PolygonRenderer };\n\n\n// WEBPACK FOOTER //\n// ./js/PolygonRenderer.js","class Tile {\n\n    constructor(x, y, h) {\n        this.x = x;\n        this.y = y;\n        this.h = h;\n        this.left = null;\n        this.right = null;\n        this.top = null;\n        this.down = null;\n        this.mapObject = null;\n    }\n\n    link(dir, tile) {\n        this[dir] = tile;\n    }\n\n    getX() {\n        return this.x;\n    }\n\n    getY() {\n        return this.y;\n    }\n\n    getH() {\n        return this.h;\n    }\n\n    setMapObject(mapObject) {\n        this.mapObject = mapObject;\n    }\n\n    unsetMapObject() {\n        this.mapObject = null;\n    }\n\n    getMapObject() {\n        return this.mapObject;\n    }\n\n    getPaths(dist) {\n        const dirs = ['left', 'right', 'top', 'down'];\n        let queue = new Set([this]);\n        let nextQueue;\n        const paths = {};\n        const thisKey = `${this.getX()}-${this.getY()}`;\n        paths[thisKey] = [thisKey];\n        for (let i = 0; i < dist; i++) {\n            nextQueue = new Set();\n            queue.forEach(tile => {\n                const key = `${tile.getX()}-${tile.getY()}`;\n                dirs.forEach((dir) => {\n                    const t = tile[dir];\n                    if (t !== null && t !== this && t.movable() && Math.abs(t.getH() - tile.getH()) < 2) {\n                        const tkey = `${t.getX()}-${t.getY()}`;\n                        if (paths[tkey] === undefined) {\n                            nextQueue.add(t);\n                            paths[tkey] = paths[key].concat(tkey);\n                        }\n                    }\n                })\n            });\n            queue = nextQueue;\n        }\n        delete paths[thisKey];\n        return paths;\n    }\n\n    movable() {\n        if (this.mapObject !== null) {\n            return this.mapObject.moveable();\n        }\n        return true;\n    }\n\n    serialize() {\n        return `${this.constructor.name()}-${this.h}`\n    }\n\n    static getClass(name) {\n        return TILE_MAP[name];\n    }\n\n}\n\nclass PlainTile extends Tile {\n\n    static name() {\n        return 'p';\n    }\n}\n\nclass EmptyTile extends Tile {\n\n    movable() {\n        return false;\n    }\n\n    getNeighbors() {\n        return new Set();\n    }\n\n    static name() {\n        return 'e';\n    }\n}\n\nconst TILE_MAP = {\n    p: PlainTile,\n    e: EmptyTile,\n};\n\nexport { Tile, EmptyTile, PlainTile };\n\n\n// WEBPACK FOOTER //\n// ./js/Tile.js","import { Point, Vector } from './Vector';\n\nclass Viewport {\n\n    /*\n        p1 (origin)       p2\n        --------------------\n        |                  |\n        |                  |\n        |                  |\n        --------------------\n        p3                p4\n     */\n    constructor(p1, p2, p3, p4, d=-1) {\n        this.p1 = p1;\n        this.p2 = p2;\n        this.p3 = p3;\n        this.p4 = p4;\n        this.d = d;\n        this.calcVectors();\n\n        this.rates = {\n            r1: 0,\n            r2: 0,\n            t1: 0,\n            t2: 0,\n            t3: 0,\n        };\n        this.mx = null;\n        this.my = null;\n        this.animation = null;\n    }\n\n    projectFace(face) {\n        const points = face.getPoints();\n        const n = face.getNormal();\n        const visiblePoints = [];\n        const clippedPoints = [];\n        const mapping = [];\n        let viewVector, pointVector, pz, li, lz, ri, rz, midpoint, projected;\n        let threshold = this.d;\n        let visible = null;\n        if (this.d === -1) {\n            threshold = 0;\n            visible = this.unitNormal.dot(n) < 0;\n        }\n\n        for (let i = 0; i < points.length; i++) {\n            if (this.d !== -1) {\n                viewVector = Vector.createFromPoints(this.p5, points[i]);\n            } else {\n                viewVector = Vector.createFromPoints(this.midpoint, points[i]);\n            }\n            pz = viewVector.dot(this.unitNormal);\n            if (pz >= threshold) {\n                if (visible === null) {\n                    visible = viewVector.dot(n) < 0;\n                }\n                if (this.d === -1) {\n                    pointVector = Vector.createFromPoints(this.p1, points[i]);\n                } else {\n                    midpoint = this.p5.midpoint(points[i], this.d / pz);\n                    pointVector = Vector.createFromPoints(this.p1, midpoint);\n                }\n                projected = new Point(pointVector.dot(this.basis1), pointVector.dot(this.basis2), 0);\n                visiblePoints.push(projected);\n                mapping.push(i);\n            } else {\n                li = i == 0 ? points.length - 1 : i - 1;\n                if (this.d !== -1) {\n                    viewVector = Vector.createFromPoints(this.p5, points[li]);\n                } else {\n                    viewVector = Vector.createFromPoints(this.midpoint, points[li]);\n                }\n                lz = viewVector.dot(this.unitNormal);\n                if (lz >= threshold) {\n                    midpoint = points[i].midpoint(points[li], (threshold - pz) / (lz - pz));\n                    pointVector = Vector.createFromPoints(this.p1, midpoint);\n                    projected = new Point(pointVector.dot(this.basis1), pointVector.dot(this.basis2), 0);\n                    visiblePoints.push(projected);\n                    mapping.push([li, i]);\n                }\n                ri = i == points.length - 1 ? 0 : i + 1;\n                if (this.d !== -1) {\n                    viewVector = Vector.createFromPoints(this.p5, points[ri]);\n                } else {\n                    viewVector = Vector.createFromPoints(this.midpoint, points[ri]);\n                }\n                rz = viewVector.dot(this.unitNormal);\n                if (rz >= threshold) {\n                    midpoint = points[i].midpoint(points[ri], (threshold - pz) / (rz - pz));\n                    pointVector = Vector.createFromPoints(this.p1, midpoint);\n                    projected = new Point(pointVector.dot(this.basis1), pointVector.dot(this.basis2), 0);\n                    visiblePoints.push(projected);\n                    mapping.push([i, ri]);\n                }\n            }\n        }\n        return {\n            visiblePoints,\n            mapping,\n            visible\n        };\n    }\n\n    projectPoint(point) {\n        let viewVector, pointVector, threshold;\n        if (this.d !== -1) {\n            viewVector = Vector.createFromPoints(this.p5, point);\n            threshold = this.d;\n        } else {\n            viewVector = Vector.createFromPoints(this.midpoint, point);\n            threshhold = 0;\n        }\n\n        const pz = viewVector.dot(this.unitNormal);\n        if (pz >= threshold) {\n            if (this.d !== -1) {\n                const midpoint = this.p5.midpoint(point, this.d / pz);\n                pointVector = Vector.createFromPoints(this.p1, midpoint);\n            } else {\n                pointVector = Vector.createFromPoints(this.p1, point);\n            }\n            return new Point(pointVector.dot(this.basis1), pointVector.dot(this.basis2), 0);\n        }\n        return null;\n    }\n\n    calcViewAngle(point, vector) {\n        let viewVector;\n        if (this.d !== -1) {\n            viewVector = Vector.createFromPoints(this.p5, point);\n        } else {\n            viewVector = this.unitNormal;\n        }\n        const cosTheta = viewVector.dot(vector) / viewVector.getMag();\n        return Math.acos(cosTheta);\n    }\n\n    calcVectors() {\n        this.basis1 = Vector.createFromPoints(this.p1, this.p2);\n        this.width = this.basis1.mag;\n        this.basis1.normalize();\n        this.basis2 = Vector.createFromPoints(this.p1, this.p3);\n        this.height = this.basis2.mag;\n        this.basis2.normalize();\n        this.unitNormal = this.basis2.cross(this.basis1);\n        this.midpoint = this.p1.midpoint(this.p4, 0.5);\n        if (this.d !== -1) {\n            const xDist = this.unitNormal.x * this.d; \n            const yDist = this.unitNormal.y * this.d;\n            const zDist = this.unitNormal.z * this.d;\n            this.p5 = this.midpoint.copy()\n            this.p5.translate(-xDist, -yDist, -zDist);\n        }\n    }\n\n    translateAlongBasis(s1, s2, s3) {\n        const xDist = this.basis1.x * s1 + this.basis2.x * s2 + this.unitNormal.x * s3;\n        const yDist = this.basis1.y * s1 + this.basis2.y * s2 + this.unitNormal.y * s3;\n        const zDist = this.basis1.z * s1 + this.basis2.z * s2 + this.unitNormal.z * s3;\n        this.translate(xDist, yDist, zDist);\n    }\n\n    translate(x, y, z, calc=true) {\n        this.p1.translate(x, y, z);\n        this.p2.translate(x, y, z);\n        this.p3.translate(x, y, z);\n        this.p4.translate(x, y, z);\n        if (calc) {\n            this.calcVectors();\n        }\n    }\n\n    rotateByBasis(theta1, theta2, theta3) {\n        const xDist = this.midpoint.getX();\n        const yDist = this.midpoint.getY();\n        const zDist = this.midpoint.getZ();\n        const rad1 = theta1 / 360 * Math.PI;\n        const rad2 = theta2 / 360 * Math.PI;\n        const rad3 = theta3 / 360 * Math.PI;\n\n        this.translate(-xDist, -yDist, -zDist, false);\n        this.p1.rotate(this.basis1, rad1);\n        this.p1.rotate(this.basis2, rad2);\n        this.p1.rotate(this.unitNormal, rad3);\n        this.p2.rotate(this.basis1, rad1);\n        this.p2.rotate(this.basis2, rad2);\n        this.p2.rotate(this.unitNormal, rad3);\n        this.p3.rotate(this.basis1, rad1);\n        this.p3.rotate(this.basis2, rad2);\n        this.p3.rotate(this.unitNormal, rad3);\n        this.p4.rotate(this.basis1, rad1);\n        this.p4.rotate(this.basis2, rad2);\n        this.p4.rotate(this.unitNormal, rad3);\n        this.translate(xDist, yDist, zDist, true);\n    }\n\n    animate(animation) {\n        return new Promise((resolve, reject) => {\n            animation.resolve = resolve;\n            this.animation = animation;\n        });\n    }\n\n    updatePosition() {\n        if (this.animation !== null) {\n            if (this.animation.rate === null) {\n                this.animation.rate = {\n                    x: (this.animation.endpoint.getX() - this.p1.getX()) / this.animation.frames,\n                    y: (this.animation.endpoint.getY() - this.p1.getY()) / this.animation.frames,\n                    z: (this.animation.endpoint.getZ() - this.p1.getZ()) / this.animation.frames\n                }\n            }\n            const dx = this.animation.rate.x;\n            const dy = this.animation.rate.y;\n            const dz = this.animation.rate.z;\n            this.translate(dx, dy, dz);\n            this.animation.frames -= 1;\n            if (this.animation.frames === 0) {\n                this.animation.resolve();\n                this.animation = null;\n            }\n        } else {\n            if (this.rates.r1 || this.rates.r2) {\n                this.rotateByBasis(this.rates.r1, this.rates.r2, 0);\n            }\n            if (this.rates.t1 || this.rates.t2 || this.rates.t3) {\n                this.translateAlongBasis(this.rates.t1, this.rates.t2, this.rates.t3);\n            }\n        }\n    }\n\n    updateRates(rates) {\n        this.rates.r1 += (rates.r1 || 0);\n        this.rates.r2 += (rates.r2 || 0);\n        this.rates.t1 += (rates.t1 || 0);\n        this.rates.t2 += (rates.t2 || 0);\n        this.rates.t3 += (rates.t3 || 0);\n    }\n\n    setMouse(x, y) {\n        this.mx = x;\n        this.my = y;\n    }\n\n    mouseInside(points) {\n        if (this.mx === null && this.my === null) {\n            return false;\n        }\n        let zPos = null;\n        for (let i = 0; i < points.length; i++) {\n            const p = points[i];\n            const np = i === points.length - 1 ? points[0] : points[i + 1];\n            const v1 = {\n                x: np.getX() - p.getX(),\n                y: np.getY() - p.getY(),\n            };\n            const v2 = {\n                x: this.mx - p.getX(),\n                y: this.my - p.getY(),\n            };\n            const cross = (v1.x * v2.y) - (v1.y * v2.x);\n            if (zPos === null) {\n                zPos = cross > 0;\n            } else if ((cross > 0) !== zPos) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n    getViewDir(point, n) {\n        let dot;\n        if (this.d === -1) {\n            dot = n.dot(this.unitNormal);\n        } else {\n            dot = n.dot(Vector.createFromPoints(this.p5, point));\n        }\n        return dot <= 0 ? 'towards' : 'away';\n    }\n\n    getViewVector(point) {\n        if (this.d !== -1) {\n            return new Vector.createFromPoints(this.p5, point);\n        } else {\n            return this.unitNormal;\n        }\n    }\n\n    getCenteredP1(point, dist) {\n        const px = point.getX() - dist * this.unitNormal.getX();\n        const py = point.getY() - dist * this.unitNormal.getY();\n        const pz = point.getZ() - dist * this.unitNormal.getZ();\n        const dx = px - this.midpoint.getX();\n        const dy = py - this.midpoint.getY();\n        const dz = pz - this.midpoint.getZ();\n        return new Point(this.p1.getX() + dx, this.p1.getY() + dy, this.p1.getZ() + dz);\n    }\n}\n\nexport { Viewport };\n\n\n// WEBPACK FOOTER //\n// ./js/Viewport.js","import Game from \"./Game\";\nimport \"../css/main.css\"\n\nconst g = new Game(window.innerWidth - 16, window.innerHeight - 16);\ng.start();\n\n\n// WEBPACK FOOTER //\n// ./js/main.js","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n\n\n\n// WEBPACK FOOTER //\n// ./~/css-loader/lib/css-base.js","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./~/style-loader/lib/urls.js","exports = module.exports = require(\"../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \"canvas {\\n\\tborder: 1px solid black;\\n}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader!./css/main.css\n// module id = 17\n// module chunks = 0","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(selector) {\n\t\tif (typeof memo[selector] === \"undefined\") {\n\t\t\tmemo[selector] = fn.call(this, selector);\n\t\t}\n\n\t\treturn memo[selector]\n\t};\n})(function (target) {\n\treturn document.querySelector(target)\n});\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton) options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n\tif (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else {\n\t\tthrow new Error(\"Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\toptions.attrs.type = \"text/css\";\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\toptions.attrs.type = \"text/css\";\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = options.transform(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/style-loader/lib/addStyles.js\n// module id = 18\n// module chunks = 0"],"sourceRoot":""}