{"version":3,"sources":["webpack:///webpack/bootstrap 5d49a43da9059d5df60b","webpack:///./js/Vector.js","webpack:///./js/MapSerializer.js","webpack:///./js/Game.js","webpack:///./css/main.css?b1a5","webpack:///./js/BSPTree.js","webpack:///./js/DefaultMap.js","webpack:///./js/Map.js","webpack:///./js/MapObject.js","webpack:///./js/MapScreen.js","webpack:///./js/Objective.js","webpack:///./js/Polygon.js","webpack:///./js/PolygonRenderer.js","webpack:///./js/Tile.js","webpack:///./js/Viewport.js","webpack:///./js/main.js","webpack:///./~/css-loader/lib/css-base.js","webpack:///./~/style-loader/lib/urls.js","webpack:///./css/main.css","webpack:///./~/style-loader/lib/addStyles.js"],"names":["Point","x","y","z","p","perc","getX","getY","getZ","v","rad","cost","Math","cos","sint","sin","mcost","vx","vy","vz","dot","newx","newy","newz","Vector","mag","sqrt","p1","p2","serialize","map","mapString","tiles","getTiles","i","length","tileRow","j","tile","tileString","mapObjects","getMapObjects","mapObject","mapObjectString","getObjective","serializeTurnPlayers","serializeActions","deserialize","splitString","split","tileArrayString","mapObjectArrayString","settings","tileRowStrings","tileStrings","props","tileClass","getClass","link","push","mapObjectStrings","objective","turnPlayers","deserializeTurnPlayers","actions","deserializeActions","Game","width","height","canvas","document","createElement","body","appendChild","screen","start","window","dmap","addEventListener","e","rect","getBoundingClientRect","handleClick","clientX","left","clientY","top","handleMouseDown","handleMouseMove","handleMouseUp","handleMouseLeave","preventDefault","handleKeyDown","code","handleKeyUp","BSPTree","faces","nodes","front","back","p0","getPoints","n","getNormal","frontFaces","backFaces","pos","cut","frontPoints","backPoints","points","lastD","createFromPoints","d","prevP","prevD","mid","midpoint","getPolygon","splitFace","face1","face2","fn","viewport","viewDir","getViewDir","traverse","exampleMapString","defaultMap","Map","turnPlayer","turnPlayerIdx","flattenedArray","forEach","row","concat","getTilesFlattened","t","getMapObject","filter","m","ret","idx","move","transfer","attack","check","name","sx","sy","dx","dy","srcTile","obj","dstTile","Object","values","reduce","a","b","str","s","parseInt","MapObject","setMapObject","constructor","cls","NAME_MAP","slice","Shard","unsetMapObject","BlueShard","RedShard","YellowShard","Vessel","arguments","player","movement","range","Error","mO","getPlayer","getShard","consumeShard","WhiteVessel","getNeighbors","has","attackedBy","shard","BlueVessel","RedVessel","YellowVessel","bs","rs","ys","w","r","MapScreen","pressed","TLEN","polygons","createBox","getH","renderer","renderLoop","updatePosition","render","requestAnimationFrame","step","turnActor","mapRenderer","centerOn","setMouse","updateRates","t1","t3","t2","r1","r2","Objective","num","success","OBJECT_FNS","players","enemies","Polygon","type","face","setPolygon","clippedFace","hover","newFacePoints","clippedPoints","getClippedPoints","c","minDist","minDistIdx","match","cp","nextcp","currDist","getMag","cDist1","cDist2","distInc","splice","PolygonFace","setVisiblePoints","points1","points2","indexOf","blacklist","getEdgeBlacklist","sharedPoints","face1Blacklist","face2Blacklist","idx1","idx2","nidx","pidx","setEdgeBlacklist","l","h","unitNormal","normal","polygon","visiblePoints","mapping","edgeBlacklist","ctx","fillColor","getHover","fillStyle","beginPath","k","moveTo","lineTo","fill","nextK","edge","strokeStyle","stroke","PolygonRenderer","staticPolygons","bsp","getFaces","hoveredPolygon","getContext","clearRect","facesToDraw","hoveredFace","projectFace","visible","mouseInside","calcClippedFace","getClippedFace","getVisiblePoints","toggleHover","draw","Tile","right","down","dir","dist","dirs","queue","Set","nextQueue","results","movable","add","TILE_MAP","PlainTile","EmptyTile","Viewport","p3","p4","calcVectors","rates","mx","my","animation","viewVector","pointVector","pz","li","lz","ri","rz","projected","threshold","p5","basis1","basis2","point","threshhold","vector","cosTheta","acos","normalize","cross","xDist","yDist","zDist","copy","translate","s1","s2","s3","calc","theta1","theta2","theta3","rad1","PI","rad2","rad3","rotate","Promise","resolve","reject","rate","endpoint","frames","dz","rotateByBasis","translateAlongBasis","zPos","np","v1","v2","px","py","g","innerWidth","innerHeight","module","exports","useSourceMap","list","toString","item","content","cssWithMappingToString","join","modules","mediaQuery","alreadyImportedModules","id","cssMapping","btoa","sourceMapping","toComment","sourceURLs","sources","source","sourceRoot","sourceMap","base64","unescape","encodeURIComponent","JSON","stringify","data","css","location","baseUrl","protocol","host","currentDir","pathname","replace","fixedCss","fullMatch","origUrl","unquotedOrigUrl","trim","o","$1","test","newUrl"],"mappings":"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;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA,iBAAiB,mBAAmB;AACpC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,iBAAiB,sBAAsB;AACvC;;AAEA;AACA,mBAAmB,2BAA2B;;AAE9C;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB,mBAAmB;AACnC;AACA;;AAEA;AACA;;AAEA,iBAAiB,2BAA2B;AAC5C;AACA;;AAEA,QAAQ,uBAAuB;AAC/B;AACA;AACA,GAAG;AACH;;AAEA,iBAAiB,uBAAuB;AACxC;AACA;;AAEA,2BAA2B;AAC3B;AACA;AACA;;AAEA;AACA;AACA;;AAEA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;AACA,cAAc;;AAEd,kDAAkD,sBAAsB;AACxE;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uDAAuD;AACvD;;AAEA,6BAA6B,mBAAmB;;AAEhD;;AAEA;;AAEA;AACA","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 14);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 5d49a43da9059d5df60b","class Point {\n\n    constructor(x, y, z) {\n        this.x = x;\n        this.y = y;\n        this.z = z;\n    }\n\n    midpoint(p, perc) {\n        const x = (1 - perc) * this.x + perc * p.getX();\n        const y = (1 - perc) * this.y + perc * p.getY();\n        const z = (1 - perc) * this.z + perc * p.getZ();\n        return new Point(x, y, z);\n    }\n\n    getX() {\n        return this.x;\n    }\n\n    getY() {\n        return this.y;\n    }\n\n    getZ() {\n        return this.z;\n    }\n\n    translate(x, y, z) {\n        this.x += x;\n        this.y += y;\n        this.z += z;\n    }\n\n    rotate(v, rad) {\n        const cost = Math.cos(rad);\n        const sint = Math.sin(rad);\n        const mcost = 1 - cost;\n        const vx = v.getX();\n        const vy = v.getY();\n        const vz = v.getZ();\n        const dot = this.x * vx + this.y * vy + this.z * vz;\n        const newx = this.x * cost + (vy * this.z - vz * this.y) * sint + vx * dot * mcost;\n        const newy = this.y * cost + (vz * this.x - vx * this.z) * sint + vy * dot * mcost;\n        const newz = this.z * cost + (vx * this.y - vy * this.x) * sint + vz * dot * mcost;\n        this.x = newx;\n        this.y = newy;\n        this.z = newz;\n    }\n\n    dot(p) {\n        return this.x * p.getX() + this.y * p.getY() + this.z * p.getZ();\n    }\n\n    copy() {\n        return new Point(this.x, this.y, this.z);\n    }\n\n    equals(p) {\n        return this.x === p.getX() && this.y === p.getY() && this.z === p.getZ();\n    }\n}\n\nclass Vector {\n\n    constructor(x, y, z) {\n        this.x = x;\n        this.y = y;\n        this.z = z;\n        this.mag = Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\n    }\n\n    static createFromPoints(p1, p2) {\n        return new Vector(p2.getX() - p1.getX(), p2.getY() - p1.getY(), p2.getZ() - p1.getZ());\n    }\n\n    getX() {\n        return this.x;\n    }\n\n    getY() {\n        return this.y;\n    }\n\n    getZ() {\n        return this.z;\n    }\n\n    getMag() {\n        return this.mag;\n    }\n\n    normalize() {\n        this.x = this.x / this.mag;\n        this.y = this.y / this.mag;\n        this.z = this.z / this.mag;\n        this.mag = 1;\n    }\n\n    cross(v) {\n        const vx = v.getX();\n        const vy = v.getY();\n        const vz = v.getZ();\n        const x = this.y * vz - this.z * vy;\n        const y = this.z * vx - this.x * vz;\n        const z = this.x * vy - this.y * vx;\n        return new Vector(x, y, z);\n    }\n\n    dot(v) {\n        return this.x * v.getX() + this.y * v.getY() + this.z * v.getZ();\n    }\n\n    equals(v) {\n        return this.x === v.getX() && this.y === v.getY() && this.z === v.getZ();\n    }\n}\n\nexport { Point, Vector };\n\n\n// WEBPACK FOOTER //\n// ./js/Vector.js","import { Tile } from \"./Tile\";\nimport { MapObject } from \"./MapObject\";\nimport { Map } from './Map';\nimport { Objective } from './Objective';\n\nfunction serialize(map) {\n    let mapString = '';\n    const tiles = map.getTiles();\n    for (let i = 0; i < tiles.length; i++) {\n        const tileRow = tiles[i];\n        for (let j = 0; j < tileRow.length; j++) {\n            const tile = tileRow[j];\n            const tileString = tile.serialize();\n            mapString += tileString;\n            if (j !== tileRow.length - 1) {\n                mapString += ' ';\n            }\n        }\n        mapString += '\\n';\n    }\n    mapString += '===\\n';\n    const mapObjects = map.getMapObjects();\n    for (let i = 0; i < mapObjects.length; i++) {\n        const mapObject = mapObjects[i];\n        const mapObjectString = mapObject.serialize();\n        mapString += mapObjectString;\n        mapString += '\\n';\n    }\n    mapString += '===\\n';\n    mapString += map.getObjective().serialize();\n    mapString += '\\n';\n    mapString += map.serializeTurnPlayers();\n    mapString += '\\n';\n    mapString += map.serializeActions();\n    return mapString;\n}\n\nfunction deserialize(mapString) {\n    const splitString = mapString.split('\\n===\\n');\n    const tileArrayString = splitString[0];\n    const mapObjectArrayString = splitString[1];\n    const settings = splitString[2].split('\\n');\n\n    const tiles = [];\n    const tileRowStrings = tileArrayString.split('\\n');\n    for (let y = 0; y < tileRowStrings.length; y++) {\n        const tileRow = [];\n        const tileStrings = tileRowStrings[y].split(' ');\n        for (let x = 0; x < tileStrings.length; x++) {\n            const props = tileStrings[x].split('-');\n            const tileClass = Tile.getClass(props[0]);\n            const tile = new tileClass(x, y, props[1]);\n\n            if (x > 0) {\n                tile.link('left', tileRow[x - 1]);\n                tileRow[x - 1].link('right', tile);\n            }\n            if (y > 0) {\n                tile.link('top', tiles[y - 1][x]);\n                tiles[y - 1][x].link('down', tile);\n            }\n            tileRow.push(tile);\n        }\n        tiles.push(tileRow);\n    }\n\n    const mapObjectStrings = mapObjectArrayString.split('\\n');\n    for (let i = 0; i < mapObjectStrings.length; i++) {\n        const mapObject = MapObject.deserialize(mapObjectStrings[i], tiles);\n    }\n\n    const objective = Objective.deserialize(settings[0]);\n    const turnPlayers = Map.deserializeTurnPlayers(settings[1]);\n    const actions = Map.deserializeActions(settings[2]);\n    return new Map(tiles, objective, turnPlayers, actions);\n}\n\nexport { serialize, deserialize }\n\n\n\n// WEBPACK FOOTER //\n// ./js/MapSerializer.js","import { MapScreen } from \"./MapScreen\";\nimport DefaultMap from \"./DefaultMap\";\n\nexport default class Game {\n    constructor(width, height) {\n        this.canvas = document.createElement(\"canvas\");\n        this.canvas.width = width;\n        this.canvas.height = height;\n    }\n\n    start() {\n        document.body.appendChild(this.canvas);\n        this.screen = new MapScreen(this.canvas, DefaultMap);\n        this.screen.start();\n        window.dmap = DefaultMap;\n    \n        this.canvas.addEventListener(\"click\", (e) => {\n            const rect = this.canvas.getBoundingClientRect();\n            this.screen.handleClick(e.clientX - rect.left, e.clientY - rect.top);\n        });\n\n        this.canvas.addEventListener(\"mousedown\", (e) => {\n            const rect = this.canvas.getBoundingClientRect();\n            this.screen.handleMouseDown(e.clientX - rect.left, e.clientY - rect.top);\n        });\n\n        this.canvas.addEventListener(\"mousemove\", (e) => {\n            const rect = this.canvas.getBoundingClientRect();\n            this.screen.handleMouseMove(e.clientX - rect.left, e.clientY - rect.top);\n        });\n\n        this.canvas.addEventListener(\"mouseup\", (e) => {\n            const rect = this.canvas.getBoundingClientRect();\n            this.screen.handleMouseUp(e.clientX - rect.left, e.clientY - rect.top);\n        });\n\n        this.canvas.addEventListener(\"mouseleave\", (e) => {\n            this.screen.handleMouseLeave();\n        });\n\n        document.addEventListener(\"keydown\", (e) => {\n            e.preventDefault();\n            this.screen.handleKeyDown(e.code);\n        });\n\n        document.addEventListener(\"keyup\", (e) => {\n            e.preventDefault();\n            this.screen.handleKeyUp(e.code);\n        });\n\n        /*this.loadAssets().then(() => {\n\n            this.canvas.addEventListener(\"click\", (e) => {\n                console.log(e);\n            });\n\n            this.loadDemo();\n        });*/\n    }\n\n    /*loadAssets() {\n        let loadingPromise = new Promise((resolve, reject) => {\n            resolve();\n        });\n        return loadingPromise\n    }*/\n}\n\n\n// WEBPACK FOOTER //\n// ./js/Game.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../node_modules/css-loader/index.js!./main.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../node_modules/css-loader/index.js!./main.css\", function() {\n\t\t\tvar newContent = require(\"!!../node_modules/css-loader/index.js!./main.css\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./css/main.css\n// module id = 3\n// module chunks = 0","import { Vector } from './Vector';\n\nclass BSPTree {\n    \n    constructor(faces) {\n        this.nodes = [];\n        this.front = null;\n        this.back = null;\n        if (faces.length == 0) {\n            return;\n        }\n\n        this.nodes = [faces[0]];\n        const p0 = faces[0].getPoints()[0];\n        const n = faces[0].getNormal();\n        const frontFaces = [];\n        const backFaces = [];\n\n        for (let i = 1; i < faces.length; i++) {\n            let pos;\n            let cut = false;\n            const frontPoints = [];\n            const backPoints = [];\n            const points = faces[i].getPoints();\n\n            //Get initial pos\n            const lastD = Vector.createFromPoints(p0, points[points.length - 1]).dot(n);\n            if (lastD === 0) {\n                pos = null;\n            } else if (lastD > 0) {\n                pos = 'front';\n            } else {\n                pos = 'back';\n            }\n\n            // Iterate over points\n            for (let j = 0; j < points.length; j++) {\n                const p = points[j];\n                const d = Vector.createFromPoints(p0, p).dot(n);\n                if (d === 0) {\n                    pos = null;\n                    frontPoints.push(p);\n                    backPoints.push(p);\n                } else if (d > 0) {\n                    if (pos === 'back') {\n                        const prevP = j === 0 ? points[points.length - 1] : points[j - 1];\n                        const prevD = Vector.createFromPoints(p0, prevP).dot(n);\n                        const mid = p.midpoint(prevP, d / (d - prevD));\n                        frontPoints.push(mid);\n                        backPoints.push(mid);\n                        cut = true;\n                    }\n                    frontPoints.push(p);\n                    pos = 'front';\n                } else {\n                    if (pos === 'front') {\n                        const prevP = j === 0 ? points[points.length - 1] : points[j - 1];\n                        const prevD = Vector.createFromPoints(p0, prevP).dot(n);\n                        const mid = p.midpoint(prevP, d / (d - prevD));\n                        frontPoints.push(mid);\n                        backPoints.push(mid);\n                        cut = true;\n                    }\n                    backPoints.push(p);\n                    pos = 'back';\n                }\n            }\n\n            if (cut) {\n                // Split a face...\n                const { face1, face2 } = faces[i].getPolygon().splitFace(faces[i], frontPoints, backPoints);\n                frontFaces.push(face1);\n                backFaces.push(face2);\n            } else {\n                if (frontPoints.length === points.length && backPoints.length === points.length) {\n                    this.nodes.push(faces[i]);\n                } else if (frontPoints.length === points.length) {\n                    frontFaces.push(faces[i]);\n                } else {\n                    backFaces.push(faces[i]);\n                }\n            }\n        }\n\n        if (frontFaces.length > 0) {\n            this.front = new BSPTree(frontFaces);\n        }\n        if (backFaces.length > 0) {\n            this.back = new BSPTree(backFaces);\n        }\n    }\n\n    traverse(fn, viewport) {\n        if (this.nodes.length > 0) {\n            const n = this.nodes[0].getNormal();\n            const p = this.nodes[0].getPoints()[0];\n            const viewDir = viewport.getViewDir(p, n);\n            if (viewDir === 'towards') {\n                if (this.back !== null) {\n                    this.back.traverse(fn, viewport);\n                }\n                for (let i = 0; i < this.nodes.length; i++) {\n                    fn(this.nodes[i]);\n                }\n                if (this.front !== null) {\n                    this.front.traverse(fn, viewport);\n                }\n            } else {\n                if (this.front !== null) {\n                    this.front.traverse(fn, viewport);\n                }\n                for (let i = 0; i < this.nodes.length; i++) {\n                    fn(this.nodes[i]);\n                }\n                if (this.back !== null) {\n                    this.back.traverse(fn, viewport);\n                }\n                \n            }\n        }\n    }\n}\n\nexport { BSPTree };\n\n\n// WEBPACK FOOTER //\n// ./js/BSPTree.js","import { deserialize } from \"./MapSerializer\";\n\nvar exampleMapString = \n`p-1 p-2 p-3\n===\nw-0-0-0\n===\n0\n0-1\n1-1-1`;\n/*\nvar exampleMapString = \n`p-1\np-3\n===\nk-0-0-0-20`;*/\n\nconst defaultMap = deserialize(exampleMapString);\n\nexport default defaultMap;\n\n\n// WEBPACK FOOTER //\n// ./js/DefaultMap.js","import { serialize } from \"./MapSerializer\";\n\nclass Map {\n\n    constructor(tiles, objective, turnPlayers, actions) {\n        this.tiles = tiles\n        this.objective = objective;\n        this.turnPlayers = turnPlayers;\n        this.turnPlayer = turnPlayers[0];\n        this.turnPlayerIdx = 0;\n        this.actions = actions;\n    }\n\n    getTiles() {\n        return this.tiles;\n    }\n\n    getTilesFlattened() {\n        let flattenedArray = [];\n        this.tiles.forEach((row) => {\n            flattenedArray = flattenedArray.concat(row);\n        });\n        return flattenedArray;\n    }\n\n    getMapObjects() {\n        return this.getTilesFlattened().map(t => t.getMapObject()).filter(m => m !== null);\n    }\n\n    getObjective() {\n        return this.objective;\n    }\n\n    serializeTurnPlayers() {\n        let ret = '';\n        let idx = this.turnPlayerIdx;\n        for (let i = 0; i < this.turnPlayers.length; i++) {\n            ret += this.turnPlayers[idx];\n            if (i !== this.turnPlayers.length - 1) {\n                ret += '-';\n            }\n            idx = (idx + 1) % this.turnPlayers.length;\n        }\n        return ret;\n    }\n\n    static deserializeTurnPlayers(str) {\n        return str.split('-');\n    }\n\n    getTurnPlayer() {\n        return this.turnPlayer;\n    }\n\n    serializeActions() {\n        return `${this.actions.move}-${this.actions.transfer}-${this.actions.attack}`;\n    }\n\n    static deserializeActions(str) {\n        const s = str.split('-');\n        return {\n            move: parseInt(s[0]),\n            transfer: parseInt(s[1]),\n            attack: parseInt(s[2]),\n        };\n    }\n\n    isResolved() {\n        return this.objective.check(this);\n    }\n\n    serialize() {\n        return serialize(this);\n    }\n\n    /*\n       Actions:\n        move/attack\n        transfer\n    */\n    doAction(name, sx, sy, dx, dy) {\n        if (this.actions[name] > 0) {\n            const srcTile = this.tiles[sy][sx];\n            const obj = srcTile.getMapObject();\n            const dstTile = this.tiles[dy][dx]; \n            obj[name](dstTile, this.turnPlayer);\n            this.actions[name] -= 1;\n        } \n        if (name === 'end' || Object.values(this.actions).reduce((a,b) => a + b, 0) === 0) {\n            this.turnPlayerIdx = (this.turnPlayerIdx + 1) % this.turnPlayers.length;\n            this.turnPlayer = this.turnPlayers[this.turnPlayerIdx];\n            this.actions = {\n                move: 1,\n                transfer: 1,\n                attack: 1,\n            };\n        }\n    }\n    /*\n\n    applyAction(actor, action, receiver) {\n        if (action === 'move') {\n            actor.moveTo(receiver);\n        }\n    }\n\n    clicked(obj) {\n        if (obj instanceof MapObject) {\n            //this.setSelection(obj);\n            //rerender = true;\n        } else if (obj instanceof Tile) {\n            if (obj.isHighlighted()) {\n                this.turnActor.moveTo(obj);\n            }\n        }\n    }\n\n    serialize() {\n        const serializer = new MapSerializer();\n        return serializer.serialize(this);\n    }\n\n    /*nextTurn() {\n        if (this.turnActor !== null) {\n            this.turnQueue.pop();\n            this.turnActor.subtractTicks(this.TICK_THRESHOLD);\n        }\n        while (this.turnQueue.length === 0) {\n            for (let i = 0; i < this.actors.length; i++) {\n                this.actors[i].tickForward();\n                const ticks = this.actors[i].getTicks();\n                if (ticks > this.TICK_THRESHOLD) {\n                    let idx = this.turnQueue.length;\n                    for (let j = 0; j < this.turnQueue.length; j++) {\n                        if (this.turnQueue[j][1] > ticks) {\n                            idx = j;\n                            break;\n                        }\n                    }\n                    this.turnQueue.splice(idx, 0, [this.actors[i], ticks]);\n                }\n            }\n        }\n        this.turnActor = this.turnQueue[this.turnQueue.length - 1][0];\n        return this.turnActor;\n    }*/\n\n    /*getTurnActor() {\n        return this.turnActor;\n    }\n\n    getPlayerOptions() {\n        return this.playerOptions;\n    }\n\n    setPlayerOptions(options) {\n        this.playerOptions = options;\n    }*/\n}\n\nexport { Map }\n\n\n// WEBPACK FOOTER //\n// ./js/Map.js","class MapObject {\n\n    constructor(props, tile = null) {\n        this.tile = tile;\n        if (tile !== null) {\n            tile.setMapObject(this);\n        }\n    }\n\n    getTile() {\n        return this.tile;\n    }\n\n    getX() {\n        return this.tile.getX();\n    }\n\n    getY() {\n        return this.tile.getY();\n    }\n\n    serialize() {\n        return `${this.constructor.name()}-${this.getX()}-${this.getY()}`;\n    }\n\n    static deserialize(props, tiles) {\n        const p = props.split('-');\n        const cls = NAME_MAP[p[0]];\n        const x = parseInt(p[1]);\n        const y = parseInt(p[2]);\n        return new cls(p.slice(3, p.length), tiles[y][x]);\n    }\n\n    setReferences(tiles, mapObjects) {\n        this.tile = tiles[this.y][this.x];\n        this.tile.setMapObject(this);\n    }\n\n    getActions() {\n        return [];\n    }\n\n    getPlayer() {\n        return null;\n    }\n}\n\nclass Shard extends MapObject {\n\n    attackedBy() {\n        this.tile.unsetMapObject();\n    }\n}\n\nclass BlueShard extends Shard {\n\n    static name() {\n        return 'bs';\n    }\n}\n\nclass RedShard extends Shard {\n    static name() {\n        return 'rs';\n    }\n}\n\nclass YellowShard extends Shard {\n    static name() {\n        return 'ys';\n    }\n}\n\n\nclass Vessel extends MapObject {\n\n    constructor(props, tile) {\n        super(...arguments);\n        this.player = props[0];\n        this.movement = 4;\n        this.range = 1;\n    }\n\n\n    serialize() {\n        return `${super.serialize()}-${this.player}`\n    }\n\n    transfer(tile, player) {\n        if (player !== this.player) {\n            throw Error('Invalid action: wrong player');\n        }\n        const mO = tile.getMapObject();\n        if (mO !== null && mO.getPlayer() === this.player && this.getShard() !== null) {\n            const cls = mO.consumeShard(this.getShard());\n            new cls([mO.getPlayer()], tile);\n            new WhiteVessel([this.player], this.tile);\n        } else {\n            throw Error('Invalid transfer tile');\n        }\n    }\n\n    attack(tile, player) {\n        if (player !== this.player) {\n            throw Error('Invalid action: wrong player');\n        }\n        if (!this.tile.getNeighbors(this.range).has(tile)) {\n            throw Error('Invalid action: cannot reach tile');\n        }\n\n        const mO = tile.getMapObject();\n        if (mO !== null) {\n            mO.attackedBy(this);\n        } else {\n            throw Error('Invalid attack tile');\n        }\n    }\n\n    move(tile, player) {\n        if (player !== this.player) {\n            throw Error('Invalid action: wrong player');\n        }\n        if (!this.tile.getNeighbors(this.movement).has(tile)) {\n            throw Error('Invalid action: cannot reach tile');\n        }\n\n        const mO = tile.getMapObject();\n        if (mO === null) {\n            this.tile.unsetMapObject();\n            tile.setMapObject(this);\n            this.tile = tile;\n        } else if (mO instanceof Shard) {\n            const cls = this.consumeShard(mO);\n            new cls([this.player], tile);\n            this.tile.unsetMapObject();\n        } else {\n            throw Error('Invalid move tile');\n        }\n    }\n\n    getPlayer() {\n        return this.player;\n    }\n\n    getShard() {\n        return null;\n    }\n\n    attackedBy() {\n        this.tile.unsetMapObject();\n    }\n}\n\nclass WhiteVessel extends Vessel {\n\n    consumeShard(shard) {\n        if (shard instanceof BlueShard) {\n            return BlueVessel;\n        } else if (shard instanceof RedShard) {\n            return RedVessel;\n        } else if (shard instanceof YellowShard) {\n            return YellowVessel;\n        }\n    }\n\n    static name() {\n        return 'w';\n    }\n}\n\nclass BlueVessel extends Vessel {\n\n    static name() {\n        return 'b';\n    }\n\n    getShard() {\n        return new BlueShard();\n    }\n}\n\nclass RedVessel extends Vessel {\n\n    static name() {\n        return 'r';\n    }\n\n    getShard() {\n        return new RedShard();\n    }\n}\n\nclass YellowVessel extends Vessel {\n\n    constructor() {\n        super(...arguments);\n        this.movement = 5;\n    }\n\n    static name() {\n        return 'y';\n    }\n\n    getShard() {\n        return new YellowShard();\n    }\n}\n\nconst NAME_MAP = {\n    bs: BlueShard,\n    rs: RedShard,\n    ys: YellowShard,\n    w: WhiteVessel,\n    b: BlueVessel,\n    r: RedVessel,\n    y: YellowVessel,\n}\n\nexport { MapObject }\n\n\n// WEBPACK FOOTER //\n// ./js/MapObject.js","import { Point } from \"./Vector\";\nimport { Viewport } from \"./Viewport\";\nimport { Polygon } from \"./Polygon\";\nimport { PolygonRenderer} from \"./PolygonRenderer\";\n\nclass MapScreen {\n\n    constructor(canvas, map) {\n        this.canvas = canvas;\n        this.map = map;\n        this.viewport = new Viewport(\n            new Point(0, 0, 500),\n            new Point(this.canvas.width, 0, 500),\n            new Point(0, this.canvas.height, 500),\n            new Point(this.canvas.width, this.canvas.height, 500),\n            500\n        );\n        this.pressed = {};\n\n        const TLEN = 100;\n        const polygons = this.map.getTilesFlattened().map(t => Polygon.createBox(t.getX() * TLEN, t.getY() * TLEN, 0, TLEN, TLEN, t.getH() *TLEN));\n        this.renderer = new PolygonRenderer(this.canvas, polygons);\n    }\n\n    start() {\n        this.renderLoop();\n    }\n\n    renderLoop() {\n        this.viewport.updatePosition();\n        this.renderer.render(this.viewport);\n        window.requestAnimationFrame((step) => {\n            this.renderLoop();\n        });\n    }\n\n    /*turnLoop() {\n        if (this.map.isResolved()) {\n            // End\n        } else {\n            const turnActor = this.map.nextTurn();\n            this.animateNextTurn(turnActor).then(() => {\n                turnActor.takeTurn().then(() => {\n                    this.turnLoop();\n                });\n                //this.mapRenderer.renderMap(this.map, this.viewport);\n            });\n        }\n    }*/\n\n    animateNextTurn(turnActor) {\n        return this.mapRenderer.centerOn(turnActor);\n        //return new Promise((resolve, reject) => {\n        //    resolve();\n            //return this.mapRenderer.centerOn(turnActor);\n        //});\n    }\n\n    handleMouseDown(x, y) {\n        //this.startDragX = x;\n        //this.startDragY = y;\n    }\n\n    handleMouseMove(x, y) {\n        this.viewport.setMouse(x,y);\n        /*if (this.startDragX !== null && this.startDragY !== null) {\n            const dx = this.startDragX - x;\n            const dy = this.startDragY - y;\n            this.viewport.translateAlongBasis(dx, dy);\n            this.startDragX = x;\n            this.startDragY = y;\n        }*/\n        //this.mapRenderer.renderMap();\n    }\n\n    handleMouseUp(x, y) {\n        //this.startDragX = null;\n        //this.startDragY = null;\n    }\n\n    handleClick(x, y) {\n        //this.viewport.mx = this.viewport.x1 + x;\n        //this.viewport.my = this.viewport.y1 + y;\n        /*const clickedObj = this.mapRenderer.getClickedObject();\n        if (clickedObj instanceof Tile) {\n            const action = this.map.getSelectedAction(clickedObj);\n            if (action !== null && action.action === 'move') {\n                this.mapRenderer.animateMove(action.actor, action.receiver).then(() => {\n                    this.map.applyAction(action.actor, action.action, action.receiver);\n                });\n            }\n        } else if (clickedObj instanceof ActorAction) {\n            this.map.getTurnActor().handleAction(clickedObj);\n        }*/\n        //const clickedObjs = this.mapRenderer.getClickedObjects();\n\n        //const rerender = this.map.clicked(clickedObjs);\n        //if (rerender) {\n            //this.mapRenderer.renderMap(this.map, this.viewport);\n        //}\n    }\n\n    handleMouseLeave() {\n        this.viewport.setMouse(null, null);\n        //this.startDragX = null;\n        //this.startDragY = null;\n        //this.mapRenderer.renderMap(this.map, this.viewport);\n    }\n\n    handleKeyDown(code) {\n        if (!this.pressed[code]) {\n            this.pressed[code] = true;\n            const updateRates = {};\n            switch (code) {\n                case 'KeyA':\n                    updateRates.t1 = -20;\n                    break;\n                case 'KeyW':\n                    updateRates.t3 = 20;\n                    break;\n                case 'KeyD':\n                    updateRates.t1 = 20;\n                    break;\n                case 'KeyS':\n                    updateRates.t3 = -20;\n                    break;\n                case 'Space':\n                    updateRates.t2 = -20;\n                    break;\n                case 'ShiftLeft':\n                    updateRates.t2 = 20;\n                    break;\n                case 'ArrowUp':\n                    updateRates.r1 = -3;\n                    break;\n                case 'ArrowDown':\n                    updateRates.r1 = 3;\n                    break;\n                case 'ArrowLeft':\n                    updateRates.r2 = 3;\n                    break;\n                case 'ArrowRight':\n                    updateRates.r2 = -3;\n                    break;\n            }\n            this.viewport.updateRates(updateRates);\n        }\n    }\n\n    handleKeyUp(code) {\n        if (this.pressed[code]) {\n            this.pressed[code] = false;\n            const updateRates = {};\n            switch (code) {\n                case 'KeyA':\n                    updateRates.t1 = 20;\n                    break;\n                case 'KeyW':\n                    updateRates.t3 = -20;\n                    break;\n                case 'KeyD':\n                    updateRates.t1 = -20;\n                    break;\n                case 'KeyS':\n                    updateRates.t3 = 20;\n                    break;\n                case 'Space':\n                    updateRates.t2 = 20;\n                    break;\n                case 'ShiftLeft':\n                    updateRates.t2 = -20;\n                    break;\n                case 'ArrowUp':\n                    updateRates.r1 = 3;\n                    break;\n                case 'ArrowDown':\n                    updateRates.r1 = -3;\n                    break;\n                case 'ArrowLeft':\n                    updateRates.r2 = -3;\n                    break;\n                case 'ArrowRight':\n                    updateRates.r2 = 3;\n                    break;\n            }\n            this.viewport.updateRates(updateRates);\n        }\n    }\n}\n\nexport { MapScreen }\n\n\n// WEBPACK FOOTER //\n// ./js/MapScreen.js","class Objective {\n\n    constructor(fn, num) {\n        this.fn = fn;\n        this.num = num;\n    }\n\n    serialize() {\n        return this.num;\n    }\n\n    static deserialize(num) {\n        return new Objective(OBJECT_FNS[num], num);\n    }\n\n    check(map) {\n        return this.fn.check(map);\n    }\n\n    success(map) {\n        return this.fn.success(map);\n    }\n\n}\n\nconst OBJECT_FNS = {\n    0: {\n        check: map => {\n            let players = map.getMapObjects().map(m => m.getPlayer()).filter(p => p !== null);\n            let player = players.filter(p => p === '0');\n            let enemies =  players.filter(p => p !== '0');\n            return player.length === 0 || enemies.length === 0;\n        },\n        success: map => {\n            let players = map.getMapObjects().map(m => m.getPlayer());\n            let enemies =  players.filter(p => p !== '0' && p !== null);\n            return enemies.length === 0;\n        }\n    },\n}\n\nexport { Objective }\n\n\n// WEBPACK FOOTER //\n// ./js/Objective.js","import { Point, Vector } from \"./Vector\";\n\nclass Polygon {\n    constructor(faces, type) {\n        this.faces = faces;\n        faces.forEach(face => face.setPolygon(this));\n        this.type = type;\n        this.clippedFace = null;\n        this.hover = false;\n    }\n\n    getHover() {\n        return this.hover;\n    }\n\n    toggleHover() {\n        this.hover = !this.hover;\n    }\n\n    getFaces() {\n        return this.faces;\n    }\n\n    getClippedFace() {\n        return this.clippedFace;\n    }\n\n    calcClippedFace() {\n        let newFacePoints = null;\n        this.faces.forEach(face => {\n            const clippedPoints = face.getClippedPoints();\n            if (clippedPoints.length > 0) {\n                if (newFacePoints === null) {\n                    newFacePoints = clippedPoints.slice();\n                } else {\n                    for (let i = 0; i < clippedPoints.length; i++) {\n                        const c = clippedPoints[i];\n                        let minDist = null;\n                        let minDistIdx = null;\n                        let match = false;\n                        for (let j = 0; j < newFacePoints.length; j++) {\n                            const cp = newFacePoints[j];\n                            const nextcp = j == newFacePoints.length - 1 ? newFacePoints[0] : newFacePoints[j + 1];\n                            const currDist = Vector.createFromPoints(cp, nextcp).getMag();\n                            const cDist1 = Vector.createFromPoints(cp, c).getMag();\n                            const cDist2 = Vector.createFromPoints(nextcp, c).getMag();\n                            const distInc = cDist1 + cDist2 - currDist;\n                            if (distInc === 0) {\n                                match = true;\n                                break;\n                            }\n                            if (minDist == null || distInc < minDist) {\n                                minDist = distInc;\n                                minDistIdx = j;\n                            }\n                        }\n                        if (!match) {\n                            if (minDistIdx == newFacePoints.length - 1) {\n                                newFacePoints.splice(0, 0, c);\n                            } else {\n                                newFacePoints.splice(minDistIdx + 1, 0, c);\n                            }\n                        }\n                    }\n\n                }\n            }\n        });\n        if (newFacePoints !== null) {\n            this.clippedFace = new PolygonFace();\n            this.clippedFace.setVisiblePoints(newFacePoints, []);\n            this.clippedFace.setPolygon(this);\n        } else {\n            this.clippedFace = null;\n        }\n    }\n\n    splitFace(face, points1, points2) {\n        this.faces.splice(this.faces.indexOf(face), 1);\n        const face1 = new PolygonFace(points1, face.getNormal());\n        const face2 = new PolygonFace(points2, face.getNormal());\n        face1.setPolygon(this);\n        face2.setPolygon(this);\n\n        const blacklist = face.getEdgeBlacklist();\n        const sharedPoints = points1.filter(p => points2.indexOf(p) !== -1);\n        const face1Blacklist = [sharedPoints];\n        const face2Blacklist = [sharedPoints];\n        for (let i = 0; i < blacklist.length; i++) {\n            debugger;\n            const b = blacklist[i];\n            let idx1 = points1.indexOf(b[0]);\n            let idx2 = points1.indexOf(b[1]);\n            if (idx1 !== -1 && idx2 !== -1) {\n                face1Blacklist.push(b);\n            } else if (idx1 !== -1 && idx2 === -1) {\n                const nidx = idx1 === points1.length - 1 ? 0 : idx1 + 1;\n                const pidx = idx1 === 0 ? points1.length - 1 : idx1 - 1;\n                if (sharedPoints.indexOf(points1[nidx]) !== -1) {\n                    face1Blacklist.push([b[0], points1[nidx]]);\n                } else {\n                    face1Blacklist.push([b[0], points1[pidx]]);\n                }\n            } else if (idx1 === -1 && idx2 !== -1) {\n                const nidx = idx2 === points1.length - 1 ? 0 : idx2 + 1;\n                const pidx = idx2 === 0 ? points1.length - 1 : idx2 - 1;\n                if (sharedPoints.indexOf(points1[nidx]) !== -1) {\n                    face1Blacklist.push([b[1], points1[nidx]]);\n                } else {\n                    face1Blacklist.push([b[1], points1[pidx]]);\n                }\n            }\n\n            idx1 = points2.indexOf(b[0]);\n            idx2 = points2.indexOf(b[1]);\n            if (idx1 !== -1 && idx2 !== -1) {\n                face2Blacklist.push(b);\n            } else if (idx1 !== -1 && idx2 === -1) {\n                const nidx = idx1 === points2.length - 1 ? 0 : idx1 + 1;\n                const pidx = idx1 === 0 ? points2.length - 1 : idx1 - 1;\n                if (sharedPoints.indexOf(points2[nidx]) !== -1) {\n                    face2Blacklist.push([b[0], points2[nidx]]);\n                } else {\n                    face2Blacklist.push([b[0], points2[pidx]]);\n                }\n            } else if (idx1 === -1 && idx2 !== -1) {\n                const nidx = idx2 === points2.length - 1 ? 0 : idx2 + 1;\n                const pidx = idx2 === 0 ? points2.length - 1 : idx2 - 1;\n                if (sharedPoints.indexOf(points2[nidx]) !== -1) {\n                    face2Blacklist.push([b[1], points2[nidx]]);\n                } else {\n                    face2Blacklist.push([b[1], points2[pidx]]);\n                }\n            }\n        }\n\n        face1.setEdgeBlacklist(face1Blacklist);\n        face2.setEdgeBlacklist(face2Blacklist);\n        this.faces.push(face1);\n        this.faces.push(face2);\n        return {\n            face1,\n            face2\n        };\n    }\n\n    static createBox(x, y, z, w, l, h) {\n        const v = [\n            new Point(x, y, z + h),\n            new Point(x + w, y, z + h),\n            new Point(x + w, y + l, z + h),\n            new Point(x , y + l, z + h),\n            new Point(x, y, z),\n            new Point(x + w, y, z),\n            new Point(x + w, y + l, z),\n            new Point(x, y + l, z),\n        ];\n        const faces = [\n            new PolygonFace([v[0], v[1], v[2], v[3]], new Vector(0, 0, 1)),\n            new PolygonFace([v[1], v[2], v[6], v[5]], new Vector(1, 0, 0)),\n            new PolygonFace([v[4], v[5], v[6], v[7]], new Vector(0, 0, -1)),\n            new PolygonFace([v[0], v[1], v[5], v[4]], new Vector(0, -1, 0)),\n            new PolygonFace([v[0], v[3], v[7], v[4]], new Vector(-1, 0, 0)),\n            new PolygonFace([v[2], v[3], v[7], v[6]], new Vector(0, 1, 0))\n        ];\n\n        return new Polygon(faces, 'box');\n    }\n}\n\nclass PolygonFace {\n    constructor(points, unitNormal) {\n        this.points = points;\n        this.normal = unitNormal;\n        this.polygon = null;\n        this.visiblePoints = [];\n        this.mapping = [];\n        this.edgeBlacklist = [];\n    }\n\n    getPoints() {\n        return this.points;\n    }\n\n    getNormal() {\n        return this.normal;\n    }\n\n    getPolygon() {\n        return this.polygon;\n    }\n\n    setPolygon(polygon) {\n        this.polygon = polygon;\n    }\n\n    getClippedPoints() {\n        const clippedPoints = [];\n        for (let i = 0; i < this.mapping.length; i++) {\n            if (typeof this.mapping[i] !== 'number') {\n                clippedPoints.push(this.visiblePoints[i]);\n            }\n        }\n        return clippedPoints;\n    }\n\n    getVisiblePoints() {\n        return this.visiblePoints;\n    }\n\n    setVisiblePoints(points, mapping) {\n        this.visiblePoints = points;\n        this.mapping = mapping;\n    }\n\n    getEdgeBlacklist() {\n        return this.edgeBlacklist;\n    }\n\n    setEdgeBlacklist(blacklist) {\n        this.edgeBlacklist = blacklist;\n    }\n\n    draw(ctx) {\n        let fillColor;\n        if (this.polygon.getHover()) {\n            fillColor = \"#E6E6E6\";\n        } else {\n            fillColor = \"#CCCCCC\";\n        }\n        ctx.fillStyle = fillColor;\n        ctx.beginPath();\n        let k;\n        for (k = 0; k < this.visiblePoints.length; k++) {\n            if (k == 0) {\n                ctx.moveTo(this.visiblePoints[k].getX(), this.visiblePoints[k].getY());\n            }\n            if (k == this.visiblePoints.length - 1) {\n                ctx.lineTo(this.visiblePoints[0].getX(), this.visiblePoints[0].getY());\n            } else {\n                ctx.lineTo(this.visiblePoints[k + 1].getX(), this.visiblePoints[k + 1].getY());\n            }\n        }\n        ctx.fill();\n\n        let nextK;\n        let edge;\n        let blacklist;\n        ctx.strokeStyle = \"#000000\";\n        //Draw outline\n        for (k = 0; k < this.visiblePoints.length; k++) {\n            nextK = k === this.visiblePoints.length - 1 ? 0 : k + 1;\n            edge = null;\n            blacklist = false;\n            if (typeof this.mapping[k] === 'number') {\n                if (typeof this.mapping[nextK] === 'number') {\n                    edge = [this.points[this.mapping[k]], this.points[this.mapping[nextK]]];\n                } else {\n                    if (this.points[this.mapping[k]] === this.points[this.mapping[nextK][0]]) {\n                        edge = [this.points[this.mapping[k]], this.points[this.mapping[nextK][1]]];\n                    } else {\n                        edge = [this.points[this.mapping[k]], this.points[this.mapping[nextK][0]]];\n                    }\n                }\n            } else if (typeof this.mapping[nextK] === 'number') {\n                if (this.points[this.mapping[k][0]] === this.points[this.mapping[nextK]]) {\n                    edge = [this.points[this.mapping[k][1]], this.points[this.mapping[nextK]]];\n                } else {\n                    edge = [this.points[this.mapping[k][0]], this.points[this.mapping[nextK]]];\n                }\n            }\n\n            if (edge !== null) {\n                blacklist = this.edgeBlacklist.filter(b => b.indexOf(edge[0]) !== -1 && b.indexOf(edge[1]) !== -1).length > 0;\n            }\n\n            if (!blacklist) {\n                ctx.beginPath();\n                ctx.moveTo(this.visiblePoints[k].getX(), this.visiblePoints[k].getY());\n                ctx.lineTo(this.visiblePoints[nextK].getX(), this.visiblePoints[nextK].getY());\n                ctx.stroke();\n            }\n        }\n    }\n}\n\nexport { Polygon, PolygonFace };\n\n\n// WEBPACK FOOTER //\n// ./js/Polygon.js","import { BSPTree } from \"./BSPTree\";\n\nclass PolygonRenderer {\n    \n    constructor(canvas, staticPolygons) {\n        this.canvas = canvas;\n        this.bsp = new BSPTree(staticPolygons.reduce((a, b) => a.concat(b.getFaces()), []));\n        this.staticPolygons = staticPolygons;\n        this.hoveredPolygon = null;\n    }\n\n    render(viewport) {\n        const ctx = this.canvas.getContext('2d');\n        ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\n        const facesToDraw = [];\n        let hoveredFace = null;\n        this.bsp.traverse((face) => {\n            const { visiblePoints, mapping, visible} = viewport.projectFace(face);\n            face.setVisiblePoints(visiblePoints, mapping);\n            if (visible) {\n                if (viewport.mouseInside(visiblePoints)) {\n                    hoveredFace = face;\n                }\n                facesToDraw.push(face);\n            }\n        }, viewport);\n\n        this.staticPolygons.forEach(polygon => {\n            polygon.calcClippedFace();\n            const clippedFace = polygon.getClippedFace();\n            if (clippedFace !== null) {\n                if (viewport.mouseInside(clippedFace.getVisiblePoints())) {\n                    hoveredFace = clippedFace;\n                }\n                facesToDraw.push(clippedFace);\n            }\n        });\n\n        if (this.hoveredPolygon !== null) {\n            this.hoveredPolygon.toggleHover();\n        }\n        if (hoveredFace !== null) {\n            this.hoveredPolygon = hoveredFace.getPolygon();\n            this.hoveredPolygon.toggleHover();\n        } else {\n            this.hoveredPolygon = null;\n        }\n\n        facesToDraw.forEach(face => face.draw(ctx));\n    }\n}\n\nexport { PolygonRenderer };\n\n\n// WEBPACK FOOTER //\n// ./js/PolygonRenderer.js","class Tile {\n\n    constructor(x, y, h) {\n        this.x = x;\n        this.y = y;\n        this.h = h;\n        this.left = null;\n        this.right = null;\n        this.top = null;\n        this.down = null;\n        this.mapObject = null;\n    }\n\n    link(dir, tile) {\n        this[dir] = tile;\n    }\n\n    getX() {\n        return this.x;\n    }\n\n    getY() {\n        return this.y;\n    }\n\n    getH() {\n        return this.h;\n    }\n\n    setMapObject(mapObject) {\n        this.mapObject = mapObject;\n    }\n\n    unsetMapObject() {\n        this.mapObject = null;\n    }\n\n    getMapObject() {\n        return this.mapObject;\n    }\n\n    getNeighbors(dist) {\n        const dirs = ['left', 'right', 'top', 'down'];\n        let queue = new Set([this]);\n        let nextQueue;\n        const results = new Set();\n        for (let i = 0; i < dist; i++) {\n            nextQueue = new Set();\n            queue.forEach(tile => {\n                dirs.forEach((dir) => {\n                    if (tile[dir] !== null && tile[dir] !== this && tile[dir].movable()) {\n                        if (!results.has(tile[dir])) {\n                            results.add(tile[dir]);\n                            nextQueue.add(tile[dir]);\n                        }\n                    }\n                })\n            });\n            queue = nextQueue;\n        }\n        return results;\n    }\n\n    movable() {\n        return true;\n    }\n\n    serialize() {\n        return `${this.constructor.name()}-${this.h}`\n    }\n\n    static getClass(name) {\n        return TILE_MAP[name];\n    }\n\n}\n\nclass PlainTile extends Tile {\n\n    static name() {\n        return 'p';\n    }\n}\n\nclass EmptyTile extends Tile {\n\n    movable() {\n        return false;\n    }\n\n    getNeighbors() {\n        return new Set();\n    }\n\n    static name() {\n        return 'e';\n    }\n}\n\nconst TILE_MAP = {\n    p: PlainTile,\n    e: EmptyTile,\n};\n\nexport { Tile, EmptyTile, PlainTile };\n\n\n// WEBPACK FOOTER //\n// ./js/Tile.js","import { Point, Vector } from './Vector';\n\nclass Viewport {\n\n    /*\n        p1 (origin)       p2\n        --------------------\n        |                  |\n        |                  |\n        |                  |\n        --------------------\n        p3                p4\n     */\n    constructor(p1, p2, p3, p4, d=-1) {\n        this.p1 = p1;\n        this.p2 = p2;\n        this.p3 = p3;\n        this.p4 = p4;\n        this.d = d;\n        this.calcVectors();\n\n        this.rates = {\n            r1: 0,\n            r2: 0,\n            t1: 0,\n            t2: 0,\n            t3: 0,\n        };\n        this.mx = null;\n        this.my = null;\n        this.animation = null;\n    }\n\n    projectFace(face) {\n        const points = face.getPoints();\n        const n = face.getNormal();\n        const visiblePoints = [];\n        const clippedPoints = [];\n        const mapping = [];\n        let viewVector, pointVector, pz, li, lz, ri, rz, midpoint, projected;\n        let threshold = this.d;\n        let visible = null;\n        if (this.d === -1) {\n            threshold = 0;\n            visible = this.unitNormal.dot(n) < 0;\n        }\n\n        for (let i = 0; i < points.length; i++) {\n            if (this.d !== -1) {\n                viewVector = Vector.createFromPoints(this.p5, points[i]);\n            } else {\n                viewVector = Vector.createFromPoints(this.midpoint, points[i]);\n            }\n            pz = viewVector.dot(this.unitNormal);\n            if (pz >= threshold) {\n                if (visible === null) {\n                    visible = viewVector.dot(n) < 0;\n                }\n                if (this.d === -1) {\n                    pointVector = Vector.createFromPoints(this.p1, points[i]);\n                } else {\n                    midpoint = this.p5.midpoint(points[i], this.d / pz);\n                    pointVector = Vector.createFromPoints(this.p1, midpoint);\n                }\n                projected = new Point(pointVector.dot(this.basis1), pointVector.dot(this.basis2), 0);\n                visiblePoints.push(projected);\n                mapping.push(i);\n            } else {\n                li = i == 0 ? points.length - 1 : i - 1;\n                if (this.d !== -1) {\n                    viewVector = Vector.createFromPoints(this.p5, points[li]);\n                } else {\n                    viewVector = Vector.createFromPoints(this.midpoint, points[li]);\n                }\n                lz = viewVector.dot(this.unitNormal);\n                if (lz >= threshold) {\n                    midpoint = points[i].midpoint(points[li], (threshold - pz) / (lz - pz));\n                    pointVector = Vector.createFromPoints(this.p1, midpoint);\n                    projected = new Point(pointVector.dot(this.basis1), pointVector.dot(this.basis2), 0);\n                    visiblePoints.push(projected);\n                    mapping.push([li, i]);\n                }\n                ri = i == points.length - 1 ? 0 : i + 1;\n                if (this.d !== -1) {\n                    viewVector = Vector.createFromPoints(this.p5, points[ri]);\n                } else {\n                    viewVector = Vector.createFromPoints(this.midpoint, points[ri]);\n                }\n                rz = viewVector.dot(this.unitNormal);\n                if (rz >= threshold) {\n                    midpoint = points[i].midpoint(points[ri], (threshold - pz) / (rz - pz));\n                    pointVector = Vector.createFromPoints(this.p1, midpoint);\n                    projected = new Point(pointVector.dot(this.basis1), pointVector.dot(this.basis2), 0);\n                    visiblePoints.push(projected);\n                    mapping.push([i, ri]);\n                }\n            }\n        }\n        return {\n            visiblePoints,\n            mapping,\n            visible\n        };\n    }\n\n    projectPoint(point) {\n        let viewVector, pointVector, threshold;\n        if (this.d !== -1) {\n            viewVector = Vector.createFromPoints(this.p5, point);\n            threshold = this.d;\n        } else {\n            viewVector = Vector.createFromPoints(this.midpoint, point);\n            threshhold = 0;\n        }\n\n        const pz = viewVector.dot(this.unitNormal);\n        if (pz >= threshold) {\n            if (this.d !== -1) {\n                const midpoint = this.p5.midpoint(point, this.d / pz);\n                pointVector = Vector.createFromPoints(this.p1, midpoint);\n            } else {\n                pointVector = Vector.createFromPoints(this.p1, point);\n            }\n            return new Point(pointVector.dot(this.basis1), pointVector.dot(this.basis2), 0);\n        }\n        return null;\n    }\n\n    calcViewAngle(point, vector) {\n        let viewVector;\n        if (this.d !== -1) {\n            viewVector = Vector.createFromPoints(this.p5, point);\n        } else {\n            viewVector = this.unitNormal;\n        }\n        const cosTheta = viewVector.dot(vector) / viewVector.getMag();\n        return Math.acos(cosTheta);\n    }\n\n    calcVectors() {\n        this.basis1 = Vector.createFromPoints(this.p1, this.p2);\n        this.width = this.basis1.mag;\n        this.basis1.normalize();\n        this.basis2 = Vector.createFromPoints(this.p1, this.p3);\n        this.height = this.basis2.mag;\n        this.basis2.normalize();\n        this.unitNormal = this.basis2.cross(this.basis1);\n        this.midpoint = this.p1.midpoint(this.p4, 0.5);\n        if (this.d !== -1) {\n            const xDist = this.unitNormal.x * this.d; \n            const yDist = this.unitNormal.y * this.d;\n            const zDist = this.unitNormal.z * this.d;\n            this.p5 = this.midpoint.copy()\n            this.p5.translate(-xDist, -yDist, -zDist);\n        }\n    }\n\n    translateAlongBasis(s1, s2, s3) {\n        const xDist = this.basis1.x * s1 + this.basis2.x * s2 + this.unitNormal.x * s3;\n        const yDist = this.basis1.y * s1 + this.basis2.y * s2 + this.unitNormal.y * s3;\n        const zDist = this.basis1.z * s1 + this.basis2.z * s2 + this.unitNormal.z * s3;\n        this.translate(xDist, yDist, zDist);\n    }\n\n    translate(x, y, z, calc=true) {\n        this.p1.translate(x, y, z);\n        this.p2.translate(x, y, z);\n        this.p3.translate(x, y, z);\n        this.p4.translate(x, y, z);\n        if (calc) {\n            this.calcVectors();\n        }\n    }\n\n    rotateByBasis(theta1, theta2, theta3) {\n        const xDist = this.midpoint.getX();\n        const yDist = this.midpoint.getY();\n        const zDist = this.midpoint.getZ();\n        const rad1 = theta1 / 360 * Math.PI;\n        const rad2 = theta2 / 360 * Math.PI;\n        const rad3 = theta3 / 360 * Math.PI;\n\n        this.translate(-xDist, -yDist, -zDist, false);\n        this.p1.rotate(this.basis1, rad1);\n        this.p1.rotate(this.basis2, rad2);\n        this.p1.rotate(this.unitNormal, rad3);\n        this.p2.rotate(this.basis1, rad1);\n        this.p2.rotate(this.basis2, rad2);\n        this.p2.rotate(this.unitNormal, rad3);\n        this.p3.rotate(this.basis1, rad1);\n        this.p3.rotate(this.basis2, rad2);\n        this.p3.rotate(this.unitNormal, rad3);\n        this.p4.rotate(this.basis1, rad1);\n        this.p4.rotate(this.basis2, rad2);\n        this.p4.rotate(this.unitNormal, rad3);\n        this.translate(xDist, yDist, zDist, true);\n    }\n\n    animate(animation) {\n        return new Promise((resolve, reject) => {\n            animation.resolve = resolve;\n            this.animation = animation;\n        });\n    }\n\n    updatePosition() {\n        if (this.animation !== null) {\n            if (this.animation.rate === null) {\n                this.animation.rate = {\n                    x: (this.animation.endpoint.getX() - this.p1.getX()) / this.animation.frames,\n                    y: (this.animation.endpoint.getY() - this.p1.getY()) / this.animation.frames,\n                    z: (this.animation.endpoint.getZ() - this.p1.getZ()) / this.animation.frames\n                }\n            }\n            const dx = this.animation.rate.x;\n            const dy = this.animation.rate.y;\n            const dz = this.animation.rate.z;\n            this.translate(dx, dy, dz);\n            this.animation.frames -= 1;\n            if (this.animation.frames === 0) {\n                this.animation.resolve();\n                this.animation = null;\n            }\n        } else {\n            if (this.rates.r1 || this.rates.r2) {\n                this.rotateByBasis(this.rates.r1, this.rates.r2, 0);\n            }\n            if (this.rates.t1 || this.rates.t2 || this.rates.t3) {\n                this.translateAlongBasis(this.rates.t1, this.rates.t2, this.rates.t3);\n            }\n        }\n    }\n\n    updateRates(rates) {\n        this.rates.r1 += (rates.r1 || 0);\n        this.rates.r2 += (rates.r2 || 0);\n        this.rates.t1 += (rates.t1 || 0);\n        this.rates.t2 += (rates.t2 || 0);\n        this.rates.t3 += (rates.t3 || 0);\n    }\n\n    setMouse(x, y) {\n        this.mx = x;\n        this.my = y;\n    }\n\n    mouseInside(points) {\n        if (this.mx === null && this.my === null) {\n            return false;\n        }\n        let zPos = null;\n        for (let i = 0; i < points.length; i++) {\n            const p = points[i];\n            const np = i === points.length - 1 ? points[0] : points[i + 1];\n            const v1 = {\n                x: np.getX() - p.getX(),\n                y: np.getY() - p.getY(),\n            };\n            const v2 = {\n                x: this.mx - p.getX(),\n                y: this.my - p.getY(),\n            };\n            const cross = (v1.x * v2.y) - (v1.y * v2.x);\n            if (zPos === null) {\n                zPos = cross > 0;\n            } else if ((cross > 0) !== zPos) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n    getViewDir(point, n) {\n        let dot;\n        if (this.d === -1) {\n            dot = n.dot(this.unitNormal);\n        } else {\n            dot = n.dot(Vector.createFromPoints(this.p5, point));\n        }\n        return dot <= 0 ? 'towards' : 'away';\n    }\n\n    getViewVector(point) {\n        if (this.d !== -1) {\n            return new Vector.createFromPoints(this.p5, point);\n        } else {\n            return this.unitNormal;\n        }\n    }\n\n    getCenteredP1(point, dist) {\n        const px = point.getX() - dist * this.unitNormal.getX();\n        const py = point.getY() - dist * this.unitNormal.getY();\n        const pz = point.getZ() - dist * this.unitNormal.getZ();\n        const dx = px - this.midpoint.getX();\n        const dy = py - this.midpoint.getY();\n        const dz = pz - this.midpoint.getZ();\n        return new Point(this.p1.getX() + dx, this.p1.getY() + dy, this.p1.getZ() + dz);\n    }\n}\n\nexport { Viewport };\n\n\n// WEBPACK FOOTER //\n// ./js/Viewport.js","import Game from \"./Game\";\nimport \"../css/main.css\"\n\nconst g = new Game(window.innerWidth - 16, window.innerHeight - 16);\ng.start();\n\n\n// WEBPACK FOOTER //\n// ./js/main.js","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n\n\n\n// WEBPACK FOOTER //\n// ./~/css-loader/lib/css-base.js","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./~/style-loader/lib/urls.js","exports = module.exports = require(\"../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \"canvas {\\n\\tborder: 1px solid black;\\n}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader!./css/main.css\n// module id = 17\n// module chunks = 0","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(selector) {\n\t\tif (typeof memo[selector] === \"undefined\") {\n\t\t\tmemo[selector] = fn.call(this, selector);\n\t\t}\n\n\t\treturn memo[selector]\n\t};\n})(function (target) {\n\treturn document.querySelector(target)\n});\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton) options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n\tif (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else {\n\t\tthrow new Error(\"Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\toptions.attrs.type = \"text/css\";\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\toptions.attrs.type = \"text/css\";\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = options.transform(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/style-loader/lib/addStyles.js\n// module id = 18\n// module chunks = 0"],"sourceRoot":""}