{"version":3,"sources":["webpack:///webpack/bootstrap c8594f81671ca9edb6d2","webpack:///./js/Map.js","webpack:///./js/Game.js","webpack:///./css/main.css?b1a5","webpack:///./js/DefaultMap.js","webpack:///./js/Tile.js","webpack:///./js/main.js","webpack:///./~/css-loader/lib/css-base.js","webpack:///./~/style-loader/lib/urls.js","webpack:///./css/main.css","webpack:///./~/style-loader/lib/addStyles.js"],"names":["Map","tiles","mapObjects","actors","filter","m","isActor","TICK_THRESHOLD","turnQueue","i","length","ticks","getTicks","idx","j","splice","turnActor","flattenedArray","forEach","row","concat","objs","rerender","obj","MapObject","isHighlighted","moveTo","serializer","MapSerializer","serialize","pop","subtractTicks","tickForward","classNameToString","stringToClass","Knight","map","mapString","getTiles","tileRow","tile","tileString","getClassName","getH","getMapObjects","mapObject","mapObjectString","splitString","split","tileArrayString","mapObjectArrayString","tileRowStrings","y","tileStrings","x","props","tileClass","link","push","mapObjectStrings","classString","attrString","slice","join","mapObjectClass","deserialize","setReferences","attributes","highlighted","h","unsetMapObject","setMapObject","getX","getY","attrSplit","attr","parseInt","parseAttributes","Actor","tickAmount","amt","Promise","resolve","reject","parAttrString","turnResolve","Error","setHighlight","changeNeighbors","getMapObject","MapScreen","canvas","viewport","Viewport","z","width","height","startDragX","startDragY","pressed","a","w","s","d","mapRenderer","MapRenderer","renderMap","isResolved","nextTurn","animateNextTurn","then","takeTurn","turnLoop","dx","dy","translateAlongBasis","mx","my","key","updateRotateRate2","updateRotateRate1","p1","p2","p3","p4","p5","calcBasis1","calcBasis2","calcUnitNormal","calcFocalPoint","wx","wy","wz","Math","sqrt","hx","hy","hz","rotateRate1","rotateRate2","basis1","basis2","unitNormal","pz","px","py","cx","cy","cz","bx","by","bz","mag","scalar1","scalar2","translate","translatePoint","p","theta","mz","rotate","axis","normAxis","rad","PI","rotatePoint","ax","cost","cos","sint","sin","mcost","dot","rotateByBasis1","rotateByBasis2","rate","boundingBoxes","ctx","getContext","clearRect","updateRotation","getTilesFlattened","tlen","tx","ty","tz","points","projectedPoints","projectOntoPlane","strokeStyle","beginPath","setLineDash","lineTo","stroke","window","requestAnimationFrame","step","sx1","sx2","sy1","sy2","x1","x2","y1","y2","hover","fillStyle","fillRect","strokeRect","counter","font","fillText","clickedObjects","boundingBox","Game","document","createElement","body","appendChild","screen","start","addEventListener","e","rect","getBoundingClientRect","handleClick","clientX","left","clientY","top","handleMouseDown","handleMouseMove","handleMouseUp","handleMouseLeave","preventDefault","handleKeyDown","handleKeyUp","loadingPromise","exampleMapString","defaultMap","Tile","right","down","dir","steps","highlight","neighbors","unhighlight","PlainTile","EmptyTile","g","innerWidth","innerHeight","module","exports","useSourceMap","list","toString","item","content","cssWithMappingToString","modules","mediaQuery","alreadyImportedModules","id","cssMapping","btoa","sourceMapping","toComment","sourceURLs","sources","source","sourceRoot","sourceMap","base64","unescape","encodeURIComponent","JSON","stringify","data","css","location","baseUrl","protocol","host","currentDir","pathname","replace","fixedCss","fullMatch","origUrl","unquotedOrigUrl","trim","o","$1","test","newUrl","indexOf"],"mappings":"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;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uDAAuD;AACvD;;AAEA,6BAA6B,mBAAmB;;AAEhD;;AAEA;;AAEA;AACA","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap c8594f81671ca9edb6d2","import { Tile, PlainTile, EmptyTile } from \"./Tile\";\n\nclass Map {\n\n    constructor(tiles, mapObjects) {\n        this.tiles = tiles\n        this.mapObjects = mapObjects;\n        this.actors = mapObjects.filter(m => m.isActor());\n\n        this.TICK_THRESHOLD = 100;\n\n        // Priority Queue of actors. Format is [[actor, ticks]]\n        this.turnQueue = [];\n\n        for (let i = 0; i < this.actors.length; i++) {\n            const ticks = this.actors[i].getTicks();\n            if (ticks > this.TICK_THRESHOLD) {\n                let idx = this.turnQueue.length;\n                for (let j = 0; j < this.turnQueue.length; j++) {\n                    if (this.turnQueue[j][1] > ticks) {\n                        idx = j;\n                        break;\n                    }\n                }\n                this.turnQueue.splice(idx, 0, [this.actors[i], ticks]);\n            }\n        }\n        if (this.turnQueue.length > 0) {\n            this.turnActor = this.turnQueue[this.turnQueue.length - 1][0];\n        } else {\n            this.turnActor = null;\n        };\n    }\n\n    getTilesFlattened() {\n        let flattenedArray = [];\n        this.tiles.forEach((row) => {\n            flattenedArray = flattenedArray.concat(row);\n        });\n        return flattenedArray;\n    }\n\n    getTiles() {\n        return this.tiles;\n    }\n\n    getMapObjects() {\n        return this.mapObjects;\n    }\n\n    //TODO: Implement Map Objective Functions\n    isResolved() {\n        return false;\n    }\n\n    clicked(objs) {\n        let rerender = false;\n        for (let i = 0; i < objs.length; i++) {\n            const obj = objs[i];\n            if (obj instanceof MapObject) {\n                //this.setSelection(obj);\n                //rerender = true;\n            } else if (obj instanceof Tile) {\n                if (obj.isHighlighted()) {\n                    this.turnActor.moveTo(obj);\n                    rerender = true;\n                }\n            }\n        }\n        return rerender;\n    }\n\n    serialize() {\n        const serializer = new MapSerializer();\n        return serializer.serialize(this);\n    }\n\n    nextTurn() {\n        if (this.turnActor !== null) {\n            this.turnQueue.pop();\n            this.turnActor.subtractTicks(this.TICK_THRESHOLD);\n        }\n        while (this.turnQueue.length === 0) {\n            for (let i = 0; i < this.actors.length; i++) {\n                this.actors[i].tickForward();\n                const ticks = this.actors[i].getTicks();\n                if (ticks > this.TICK_THRESHOLD) {\n                    let idx = this.turnQueue.length;\n                    for (let j = 0; j < this.turnQueue.length; j++) {\n                        if (this.turnQueue[j][1] > ticks) {\n                            idx = j;\n                            break;\n                        }\n                    }\n                    this.turnQueue.splice(idx, 0, [this.actors[i], ticks]);\n                }\n            }\n        }\n        this.turnActor = this.turnQueue[this.turnQueue.length - 1][0];\n        return this.turnActor;\n    }\n}\n\nclass MapSerializer {\n    constructor() {\n        this.classNameToString = {\n            'Plain' : 'p',\n            'Empty' : 'e',\n            'Knight' : 'k',\n        }\n        this.stringToClass = {\n            'p': PlainTile,\n            'e': EmptyTile,\n            'k': Knight,\n        }\n    }\n\n    serialize(map) {\n        let mapString = '';\n        const tiles = map.getTiles();\n        for (let i = 0; i < tiles.length; i++) {\n            const tileRow = tiles[i];\n            for (let j = 0; j < tileRow.length; j++) {\n                const tile = tileRow[j];\n                const tileString = `${this.classNameToString[tile.getClassName()]}-${tile.getH()}`;\n                mapString += tileString;\n                if (j !== tileRow.length - 1) {\n                    mapString += ' ';\n                }\n            }\n            mapString += '\\n';\n        }\n        mapString += '===\\n';\n        const mapObjects = map.getMapObjects();\n        for (let i = 0; i < mapObjects.length; i++) {\n            const mapObject = mapObjects[i];\n            const mapObjectString = `${this.classNameToString[mapObject.getClassName()]}-${mapObject.serialize()}`;\n            mapString += mapObjectString;\n            if (i !== mapObjects.length - 1) {\n                mapString += '\\n';\n            }\n        }\n        return mapString;\n    }\n\n    deserialize(mapString) {\n        const splitString = mapString.split('\\n===\\n');\n        const tileArrayString = splitString[0];\n        const mapObjectArrayString = splitString[1];\n        const tiles = [];\n        const tileRowStrings = tileArrayString.split('\\n');\n        for (let y = 0; y < tileRowStrings.length; y++) {\n            const tileRow = [];\n            const tileStrings = tileRowStrings[y].split(' ');\n            for (let x = 0; x < tileStrings.length; x++) {\n                const props = tileStrings[x].split('-');\n                const tileClass = this.stringToClass[props[0]];\n                const tile = new tileClass(x, y, props[1]);\n\n                if (x > 0) {\n                    tile.link('left', tileRow[x - 1]);\n                    tileRow[x - 1].link('right', tile);\n                }\n                if (y > 0) {\n                    tile.link('top', tiles[y - 1][x]);\n                    tiles[y - 1][x].link('down', tile);\n                }\n                tileRow.push(tile);\n            }\n            tiles.push(tileRow);\n        }\n        const mapObjects = [];\n        const mapObjectStrings = mapObjectArrayString.split('\\n');\n        for (let i = 0; i < mapObjectStrings.length; i++) {\n            const props = mapObjectStrings[i].split('-');\n            const classString = props[0];\n            const attrString = props.slice(1, props.length).join('-');\n            const mapObjectClass = this.stringToClass[props[0]];\n            const mapObject = mapObjectClass.deserialize(attrString);\n            mapObjects.push(mapObject);\n        }\n        for (let i = 0; i < mapObjects.length; i++) {\n            mapObjects[i].setReferences(tiles, mapObjects);\n        }\n        return new Map(tiles, mapObjects);\n    }\n}\n\nclass MapObject {\n\n    getClassName() {\n        return 'MapObject';\n    }\n\n    constructor(attributes) {\n        this.tile = null;\n        this.x = attributes.x;\n        this.y = attributes.y;\n        this.highlighted = false;\n    }\n\n    getTile() {\n        return this.tile;\n    }\n\n    getX() {\n        return this.x;\n    }\n\n    getY() {\n        return this.y;\n    }\n\n    isHighlighted() {\n        return this.highlighted;\n    }\n\n    setHighlight(h) {\n        this.highlighted = h;\n    }\n\n    moveTo(tile) {\n        this.tile.unsetMapObject(this);\n        tile.setMapObject(this);\n        this.tile = tile;\n        this.x = tile.getX();\n        this.y = tile.getY();\n    }\n\n    isActor() {\n        return false;\n    }\n\n    serialize() {\n        return `${this.x}-${this.getY()}`;\n    }\n\n    static parseAttributes(attrString) {\n        const attrSplit = attrString.split('-');\n        const attr = {\n            x: parseInt(attrSplit[0]),\n            y: parseInt(attrSplit[1]),\n        };\n        return attr;\n    }\n\n    static deserialize(attrString) {\n        return new this(this.parseAttributes(attrString));\n    }\n\n    setReferences(tiles, mapObjects) {\n        this.tile = tiles[this.y][this.x];\n        this.tile.setMapObject(this);\n    }\n}\n\nclass Actor extends MapObject {\n\n    constructor(attributes) {\n        super(attributes);\n        this.ticks = attributes.ticks;\n        this.tickAmount = attributes.tickAmount;\n    }\n\n    getTicks() {\n        return this.ticks;\n    }\n\n    getTickAmount() {\n        return this.tickAmount;\n    }\n\n    tickForward() {\n        this.ticks += this.tickAmount;\n    }\n\n    subtractTicks(amt) {\n        this.ticks -= amt;\n    }\n\n    isActor() {\n        return true;\n    }\n\n    takeTurn() {\n        return new Promise((resolve, reject) => {\n            resolve();\n        });\n    }\n\n    serialize() {\n        return `${super.serialize()}-${this.ticks}-${this.tickAmount}`;\n    }\n\n    static parseAttributes(attrString) {\n        const attrSplit = attrString.split('-');\n        const parAttrString = attrSplit.slice(0, attrSplit.length - 2).join('-');\n        const attr = super.parseAttributes(parAttrString);\n        attr.ticks = parseInt(attrSplit[attrSplit.length - 2]);\n        attr.tickAmount = parseInt(attrSplit[attrSplit.length - 1]);\n        return attr;\n    }\n}\n\nclass Knight extends Actor {\n\n    getClassName() {\n        return 'Knight';\n    }\n\n    constructor(attributes) {\n        super(attributes);\n\n        //attributes\n        // HP\n        // MP\n        // Speed\n        // Skill Points\n        // Attack\n        // Defense\n        // \n        this.turnResolve = function() {\n            throw Error('Called turnResolve() before it was set');\n        };\n    }\n\n    takeTurn() {\n        this.setHighlight(true);\n        this.tile.changeNeighbors(2, true, (tile) => {\n            return tile.getMapObject() == null;\n        });\n        return new Promise((resolve, reject) => {\n            this.turnResolve = resolve;\n        });\n    }\n\n    moveTo(tile) {\n        this.setHighlight(false);\n        this.tile.changeNeighbors(2, false);\n        super.moveTo(tile);\n        this.turnResolve();\n    }\n}\n\nclass MapScreen {\n\n    constructor(canvas, map) {\n        this.canvas = canvas;\n        this.map = map;\n        this.viewport = new Viewport({\n            x: 0,\n            y: 0,\n            z: 500,\n        }, {\n            x: this.canvas.width,\n            y: 0,\n            z: 500,\n        }, {\n            x: 0,\n            y: this.canvas.height,\n            z: 500,\n        }, {\n            x: this.canvas.width,\n            y: this.canvas.height,\n            z: 500,\n        }, 500);\n        this.startDragX = null;\n        this.startDragY = null;\n        this.pressed = {\n            a: false,\n            w: false,\n            s: false,\n            d: false,\n        };\n        this.mapRenderer = new MapRenderer(this.canvas, this.map, this.viewport);\n    }\n\n    start() {\n        this.mapRenderer.renderMap();\n        //this.turnLoop();\n    }\n\n    turnLoop() {\n        if (this.map.isResolved()) {\n            // End\n        } else {\n            const turnActor = this.map.nextTurn();\n            this.animateNextTurn(turnActor).then(() => {\n                turnActor.takeTurn().then(() => {\n                    this.turnLoop();\n                });\n                //this.mapRenderer.renderMap(this.map, this.viewport);\n            });\n        }\n    }\n\n    animateNextTurn(turnActor) {\n        return new Promise((resolve, reject) => {\n            resolve();\n            //return this.mapRenderer.centerOn(turnActor);\n        });\n    }\n\n    handleMouseDown(x, y) {\n        this.startDragX = x;\n        this.startDragY = y;\n    }\n\n    handleMouseMove(x, y) {\n        if (this.startDragX !== null && this.startDragY !== null) {\n            const dx = this.startDragX - x;\n            const dy = this.startDragY - y;\n            this.viewport.translateAlongBasis(dx, dy);\n            this.startDragX = x;\n            this.startDragY = y;\n        }\n        //this.mapRenderer.renderMap();\n    }\n\n    handleMouseUp(x, y) {\n        this.startDragX = null;\n        this.startDragY = null;\n    }\n\n    handleClick(x, y) {\n        //this.viewport.mx = this.viewport.x1 + x;\n        //this.viewport.my = this.viewport.y1 + y;\n        //const clickedObjs = this.mapRenderer.getClickedObjects(this.viewport);\n        //const rerender = this.map.clicked(clickedObjs);\n        //if (rerender) {\n            //this.mapRenderer.renderMap(this.map, this.viewport);\n        //}\n    }\n\n    handleMouseLeave() {\n        this.viewport.mx = null;\n        this.viewport.my = null;\n        this.startDragX = null;\n        this.startDragY = null;\n        //this.mapRenderer.renderMap(this.map, this.viewport);\n    }\n\n    handleKeyDown(key) {\n        if (key === 'a') {\n            if (!this.pressed[key]) {\n                this.viewport.updateRotateRate2(2);\n                this.pressed[key] = true;\n            }\n        } else if (key === 'w') {\n            if (!this.pressed[key]) {\n                this.viewport.updateRotateRate1(2);\n                this.pressed[key] = true;\n            }\n        } else if (key === 'd') {\n            if (!this.pressed[key]) {\n                this.viewport.updateRotateRate2(-2);\n                this.pressed[key] = true;\n            }\n        } else if (key === 's') {\n            if (!this.pressed[key]) {\n                this.viewport.updateRotateRate1(-2);\n                this.pressed[key] = true;\n            }\n        }\n    }\n\n    handleKeyUp(key) {\n        if (key === 'a') {\n            if (this.pressed[key]) {\n                this.viewport.updateRotateRate2(-2);\n                this.pressed[key] = false;\n            }\n        } else if (key === 'w') {\n            if (this.pressed[key]) {\n                this.viewport.updateRotateRate1(-2);\n                this.pressed[key] = false;\n            }\n        } else if (key === 'd') {\n            if (this.pressed[key]) {\n                this.viewport.updateRotateRate2(2);\n                this.pressed[key] = false;\n            }\n        } else if (key === 's') {\n            if (this.pressed[key]) {\n                this.viewport.updateRotateRate1(2);\n                this.pressed[key] = false;\n            }\n        }\n    }\n}\n\nclass Viewport {\n\n    /*\n        p1 (origin)       p2\n        --------------------\n        |                  |\n        |                  |\n        |                  |\n        --------------------\n        p3                p4\n     */\n    constructor(p1, p2, p3 ,p4, d=-1) {\n        this.p1 = p1;\n        this.p2 = p2;\n        this.p3 = p3;\n        this.p4 = p4;\n        this.d = d;\n        this.p5 = null;\n        this.calcBasis1();\n        this.calcBasis2();\n        this.calcUnitNormal();\n        this.calcFocalPoint();\n        const wx = p2.x - p1.x;\n        const wy = p2.y - p1.y;\n        const wz = p2.z - p2.z;\n        this.width = Math.sqrt(wx * wx + wy * wy + wz * wz);\n        const hx = p3.x - p1.x;\n        const hy = p3.y - p1.y;\n        const hz = p3.z - p1.z;\n        this.height = Math.sqrt(hx * hx + hy * hy + hz * hz);\n        this.rotateRate1 = 0;\n        this.rotateRate2 = 0;\n    }\n\n    projectOntoPlane({x, y, z}) {\n        if (this.d == -1) {\n            return {\n                x: x * this.basis1.x + y * this.basis1.y + z * this.basis1.z - this.p1.x * this.basis1.x - this.p1.y * this.basis1.y - this.p1.z * this.basis1.z,\n                y: x * this.basis2.x + y * this.basis2.y + z * this.basis2.z - this.p1.x * this.basis2.x - this.p1.y * this.basis2.y - this.p1.z * this.basis2.z,\n                z: x * this.unitNormal.x + y * this.unitNormal.y + z * this.unitNormal.z - this.p1.x * this.unitNormal.x - this.p1.y * this.unitNormal.y - this.p1.z * this.unitNormal.z,\n            };\n        } else {\n            const pz = x * this.unitNormal.x + y * this.unitNormal.y + z * this.unitNormal.z - this.p1.x * this.unitNormal.x - this.p1.y * this.unitNormal.y - this.p1.z * this.unitNormal.z;\n            const px = x * this.basis1.x + y * this.basis1.y + z * this.basis1.z - this.p1.x * this.basis1.x - this.p1.y * this.basis1.y - this.p1.z * this.basis1.z;\n            const py = x * this.basis2.x + y * this.basis2.y + z * this.basis2.z - this.p1.x * this.basis2.x - this.p1.y * this.basis2.y - this.p1.z * this.basis2.z;\n            return {\n                x: (this.width / 2 - px) / (1 + this.d / pz) + px,\n                y: (this.height / 2 - py) / (1 + this.d / pz) + py,\n                z: pz,\n            };\n        }\n    }\n\n    calcFocalPoint() {\n        if (this.d !== -1) {\n            const cx = (this.p1.x + this.p4.x) / 2;\n            const cy = (this.p1.y + this.p4.y) / 2;\n            const cz = (this.p1.z + this.p4.z) / 2;\n            this.p5 = {\n                x: cx - this.d * this.unitNormal.x,\n                y: cy - this.d * this.unitNormal.y,\n                z: cz - this.d * this.unitNormal.z,\n            };\n        }\n    }\n\n    calcBasis1() {\n        const bx = this.p2.x - this.p1.x;\n        const by = this.p2.y - this.p1.y;\n        const bz = this.p2.z - this.p1.z;\n        const mag = Math.sqrt(bx * bx + by * by + bz * bz);\n        this.basis1 = {\n            x: bx / mag,\n            y: by / mag,\n            z: bz / mag,\n        };\n    }\n\n    calcBasis2() {\n        const bx = this.p3.x - this.p1.x;\n        const by = this.p3.y - this.p1.y;\n        const bz = this.p3.z - this.p1.z;\n        const mag = Math.sqrt(bx * bx + by * by + bz * bz);\n        this.basis2 = {\n            x: bx / mag,\n            y: by / mag,\n            z: bz / mag,\n        };\n    }\n\n    // Basis \n    calcUnitNormal() {\n        this.unitNormal = {\n            x: this.basis2.y * this.basis1.z - this.basis2.z * this.basis1.y,\n            y: this.basis2.z * this.basis1.x - this.basis2.x * this.basis1.z,\n            z: this.basis2.x * this.basis1.y - this.basis2.y * this.basis1.x,\n        };\n    };\n\n    translateAlongBasis(scalar1, scalar2) {\n        this.translate({\n            x: this.basis1.x * scalar1 + this.basis2.x * scalar2,\n            y: this.basis1.y * scalar1 + this.basis2.y * scalar2,\n            z: this.basis1.z * scalar1 + this.basis2.z * scalar2,\n        });\n    }\n\n    translate(a) {\n        this.p1 = this.translatePoint(this.p1, a);\n        this.p2 = this.translatePoint(this.p2, a);\n        this.p3 = this.translatePoint(this.p3, a);\n        this.p4 = this.translatePoint(this.p4, a);\n        this.calcBasis1();\n        this.calcBasis2();\n        this.calcUnitNormal();\n        this.calcFocalPoint();\n    }\n\n    translatePoint(p, a) {\n        return {\n            x: p.x + a.x,\n            y: p.y + a.y,\n            z: p.z + a.z,\n        };\n    }\n\n    rotateByBasis1(theta) {\n        const mx = (this.p1.x + this.p4.x) / 2;\n        const my = (this.p1.y + this.p4.y) / 2;\n        const mz = (this.p1.z + this.p4.z) / 2;\n        this.translate({\n            x: -mx,\n            y: -my,\n            z: -mz,\n        });\n        this.rotate(this.basis1, theta);\n        this.translate({\n            x: mx,\n            y: my,\n            z: mz,\n        });\n    }\n\n    rotateByBasis2(theta) {\n        const mx = (this.p1.x + this.p4.x) / 2;\n        const my = (this.p1.y + this.p4.y) / 2;\n        const mz = (this.p1.z + this.p4.z) / 2;\n        this.translate({\n            x: -mx,\n            y: -my,\n            z: -mz,\n        });\n        this.rotate(this.basis2, theta);\n        this.translate({\n            x: mx,\n            y: my,\n            z: mz,\n        });\n    }\n\n    rotate(axis, theta) {\n        const mag = Math.sqrt(axis.x * axis.x + axis.y * axis.y + axis.z * axis.z);\n        const normAxis = {\n            x: axis.x / mag,\n            y: axis.y / mag,\n            z: axis.z / mag,\n        };\n        const rad = theta / 360 * Math.PI;\n        this.p1 = this.rotatePoint(this.p1, normAxis, rad);\n        this.p2 = this.rotatePoint(this.p2, normAxis, rad);\n        this.p3 = this.rotatePoint(this.p3, normAxis, rad);\n        this.p4 = this.rotatePoint(this.p4, normAxis, rad);\n        this.calcBasis1();\n        this.calcBasis2();\n        this.calcUnitNormal();\n        this.calcFocalPoint();\n    }\n\n    // Axis must be unit, Theta must be radians.\n    rotatePoint(p, ax, rad) {\n        const cost = Math.cos(rad);\n        const sint = Math.sin(rad);\n        const mcost = 1 - cost;\n        const dot = ax.x * p.x + ax.y * p.y + ax.z * p.z;\n        return {\n            x: p.x * cost + (ax.y * p.z - ax.z * p.y) * sint + ax.x * dot * mcost,\n            y: p.y * cost + (ax.z * p.x - ax.x * p.z) * sint + ax.y * dot * mcost,\n            z: p.z * cost + (ax.x * p.y - ax.y * p.x) * sint + ax.z * dot * mcost,\n        };\n    }\n\n    updateRotation() {\n        if (this.rotateRate1 !== 0) {\n            this.rotateByBasis1(this.rotateRate1);\n        }\n        if (this.rotateRate2 !== 0) {\n            this.rotateByBasis2(this.rotateRate2);\n        }\n    }\n\n    updateRotateRate1(rate) {\n        this.rotateRate1 += rate;\n    }\n\n    updateRotateRate2(rate) {\n        this.rotateRate2 += rate;\n    }\n}\n\nclass MapRenderer {\n\n    constructor(canvas, map, viewport) {\n        this.canvas = canvas;\n        this.boundingBoxes = [];\n        /*this.viewport = {\n            x1: 0,\n            x2: canvas.width,\n            y1: 0,\n            y2: canvas.height,\n        };*/\n        this.map = map;\n        this.viewport = viewport;\n    }\n\n    \n    renderMap() {\n        const ctx = this.canvas.getContext('2d');\n        ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n        this.boundingBoxes = [];\n\n        /*const drawables = this.map.getDrawables();\n        drawables.forEach((drawable) => {\n\n            //Check to see if visible given current viewport\n            th\n\n\n\n            //If yes, draw and add bounding box\n\n            drawable.getBoundingShape();\n            drawable.getBoundingBox();\n            const dx = drawable.getPixelX();\n            const dy = \n            if (drawable instanceof PlainTile) {\n\n            } else if (drawable instanceof Knight) {\n\n            }\n        });*/\n\n        this.viewport.updateRotation();\n\n        //\n        const tiles = this.map.getTilesFlattened();\n        const tlen = 100;\n        for (let i = 0; i < tiles.length; i++) {\n            const tx = tiles[i].getX() * tlen;\n            const ty = tiles[i].getY() * tlen;\n            const tz = tiles[i].getH() * tlen;\n            const points = [{\n                x: tx,\n                y: ty,\n                z: tz,\n            }, {\n                x: tx + 100,\n                y: ty,\n                z: tz,\n            }, {\n                x: tx + 100,\n                y: ty + 100,\n                z: tz,\n            }, {\n                x: tx,\n                y: ty + 100,\n                z: tz,\n            }, {\n                x: tx,\n                y: ty,\n                z: 0,\n            }, {\n                x: tx + 100,\n                y: ty,\n                z: 0,\n            }, {\n                x: tx + 100,\n                y: ty + 100,\n                z: 0,\n            }, {\n                x: tx,\n                y: ty + 100,\n                z: 0,\n            }];\n            const projectedPoints = [];\n            for (let j = 0; j < points.length; j++) {\n                projectedPoints.push(this.viewport.projectOntoPlane(points[j]));\n                //console.log(projectedPoints[j]);\n            }\n            ctx.strokeStyle = \"#000000\";\n            ctx.beginPath();\n            ctx.moveTo(projectedPoints[0].x, projectedPoints[0].y);\n            if (projectedPoints[0].z < projectedPoints[1].z) {\n                ctx.setLineDash([5, 5]);\n            } else {\n                ctx.setLineDash([]);\n            }\n            ctx.lineTo(projectedPoints[1].x, projectedPoints[1].y);\n            if (projectedPoints[1].z < projectedPoints[2].z) {\n                ctx.setLineDash([5, 5]);\n            } else {\n                ctx.setLineDash([]);\n            }\n            ctx.lineTo(projectedPoints[2].x, projectedPoints[2].y);\n            if (projectedPoints[2].z < projectedPoints[3].z) {\n                ctx.setLineDash([5, 5]);\n            } else {\n                ctx.setLineDash([]);\n            }\n            ctx.lineTo(projectedPoints[3].x, projectedPoints[3].y);\n            if (projectedPoints[3].z < projectedPoints[0].z) {\n                ctx.setLineDash([5, 5]);\n            } else {\n                ctx.setLineDash([]);\n            }\n            ctx.lineTo(projectedPoints[0].x, projectedPoints[0].y);\n            if (projectedPoints[0].z < projectedPoints[4].z) {\n                ctx.setLineDash([5, 5]);\n            } else {\n                ctx.setLineDash([]);\n            }\n            ctx.lineTo(projectedPoints[4].x, projectedPoints[4].y);\n            if (projectedPoints[4].z < projectedPoints[5].z) {\n                ctx.setLineDash([5, 5]);\n            } else {\n                ctx.setLineDash([]);\n            }\n            ctx.lineTo(projectedPoints[5].x, projectedPoints[5].y);\n            if (projectedPoints[5].z < projectedPoints[1].z) {\n                ctx.setLineDash([5, 5]);\n            } else {\n                ctx.setLineDash([]);\n            }\n            ctx.lineTo(projectedPoints[1].x, projectedPoints[1].y);\n            ctx.moveTo(projectedPoints[5].x, projectedPoints[5].y);\n            if (projectedPoints[5].z < projectedPoints[6].z) {\n                ctx.setLineDash([5, 5]);\n            } else {\n                ctx.setLineDash([]);\n            }\n            ctx.lineTo(projectedPoints[6].x, projectedPoints[6].y);\n            if (projectedPoints[6].z < projectedPoints[2].z) {\n                ctx.setLineDash([5, 5]);\n            } else {\n                ctx.setLineDash([]);\n            }\n            ctx.lineTo(projectedPoints[2].x, projectedPoints[2].y);\n            ctx.moveTo(projectedPoints[6].x, projectedPoints[6].y);\n            if (projectedPoints[6].z < projectedPoints[7].z) {\n                ctx.setLineDash([5, 5]);\n            } else {\n                ctx.setLineDash([]);\n            }\n            ctx.lineTo(projectedPoints[7].x, projectedPoints[7].y);\n            if (projectedPoints[7].z < projectedPoints[3].z) {\n                ctx.setLineDash([5, 5]);\n            } else {\n                ctx.setLineDash([]);\n            }\n            ctx.lineTo(projectedPoints[3].x, projectedPoints[3].y);\n            ctx.moveTo(projectedPoints[7].x, projectedPoints[7].y);\n            if (projectedPoints[7].z < projectedPoints[4].z) {\n                ctx.setLineDash([5, 5]);\n            } else {\n                ctx.setLineDash([]);\n            }\n            ctx.lineTo(projectedPoints[4].x, projectedPoints[4].y);\n            ctx.stroke();\n            //ctx.moveTo(projectedPoints[4].x, projectedPoints[4].y);\n            //ctx.lineTo(projectedPoints[5].x, projectedPoints[5].y);\n        }\n\n\n        //this.renderTiles(tiles, this.viewport);\n        //const mapObjects = map.getMapObjects();\n        //this.renderMapObjects(mapObjects, this.viewport);\n\n\n        window.requestAnimationFrame((step) => {\n            this.renderMap();\n        });\n    }\n\n\n\n    renderTiles(tiles, viewport) {\n        const ctx = this.canvas.getContext(\"2d\");\n        tiles.forEach((tile) => {\n            const tx = tile.getX();\n            const ty = tile.getY();\n\n            //map tx and ty into screen x and y (sx & sy) \n            const sx1 = tx * 100;\n            const sx2 = tx * 100 + 100;\n            const sy1 = ty * 100;\n            const sy2 = ty * 100 + 100;\n\n            if (sx2 >= viewport.x1 && sx1 <= viewport.x2 && sy2 >= viewport.y1 && sy1 <= viewport.y2) {\n\n                let hover = false;\n                if (viewport.mx !== null && viewport.my !== null) {\n                    if (viewport.mx > sx1 && viewport.mx < sx2 && viewport.my > sy1 && viewport.my < sy2) {\n                        hover = true;\n                    }\n                }\n                if (tile instanceof PlainTile) {\n                    ctx.strokeStyle = \"#000000\";\n                    if (tile.isHighlighted()) {\n                        if (hover) {\n                            ctx.fillStyle = \"#0066FF\";\n                        }  else {\n                            ctx.fillStyle = \"#0000FF\";\n                        }\n                    } else {\n                        if (hover) {\n                        ctx.fillStyle = \"#D9D9D9\";\n                        } else {\n                            ctx.fillStyle = \"#CCCCCC\";\n                        }\n                    }\n                    ctx.fillRect(sx1 - viewport.x1, sy1 - viewport.y1, 100, 100);\n                    ctx.strokeRect(sx1 - viewport.x1, sy1 - viewport.y1, 100, 100);\n                    this.boundingBoxes.push({\n                        obj: tile,\n                        x1: sx1,\n                        x2: sx2,\n                        y1: sy1,\n                        y2: sy2,\n                    });\n                }\n            }\n        });\n    }\n\n    renderMapObjects(mapObjects, viewport) {\n        const ctx = this.canvas.getContext(\"2d\");\n        ctx.fillStyle = \"#0000FF\";\n        ctx.strokeStyle = \"#000000\";\n        let counter = 0;\n        mapObjects.forEach((mapObject) => {\n            const mx = mapObject.getX();\n            const my = mapObject.getY();\n\n            //map tx and ty into screen x and y (sx & sy) \n            const sx1 = mx * 100;\n            const sx2 = mx * 100 + 100;\n            const sy1 = my * 100;\n            const sy2 = my * 100 + 100;\n\n            if (sx2 >= viewport.x1 && sx1 <= viewport.x2 && sy2 >= viewport.y1 && sy1 <= viewport.y2) {\n                \n                if (mapObject.isHighlighted()) {\n                    ctx.fillStyle = \"#00FF00\";\n                } else {\n                    ctx.fillStyle = \"#0000FF\";\n                }\n                ctx.fillRect(sx1 + 15 - viewport.x1, sy1 + 15 - viewport.y1, 70, 70);\n                ctx.strokeRect(sx1 + 15 - viewport.x1, sy1 + 15 - viewport.y1, 70, 70);\n                ctx.fillStyle = \"#000000\";\n                ctx.font = \"48px serif\";\n                ctx.fillText(`${counter}`,sx1 + 40 - viewport.x1, sy1 + 60 - viewport.y1);\n                counter += 1;\n                this.boundingBoxes.push({\n                    obj: mapObject,\n                    x1: sx1,\n                    x2: sx2,\n                    y1: sy1,\n                    y2: sy2,\n                });\n            }\n        });\n    }\n\n    getClickedObjects(viewport) {\n        const clickedObjects = [];\n        const mx = viewport.mx;\n        const my = viewport.my;\n        for (let i = 0; i < this.boundingBoxes.length; i++) {\n            let boundingBox = this.boundingBoxes[i];\n            if (mx > boundingBox.x1 && mx < boundingBox.x2 && my > boundingBox.y1 && my < boundingBox.y2) {\n                clickedObjects.push(boundingBox.obj);\n            }\n        }\n        return clickedObjects;\n    }\n\n    getCenteredViewport(mapObject) {\n\n    }\n}\n\nexport {Map, MapObject, MapSerializer, MapRenderer, MapScreen, Knight}\n\n\n// WEBPACK FOOTER //\n// ./js/Map.js","import { MapScreen } from \"./Map\";\nimport DefaultMap from \"./DefaultMap\";\n\nexport default class Game {\n    constructor(width, height) {\n        this.canvas = document.createElement(\"canvas\");\n        this.canvas.width = width;\n        this.canvas.height = height;\n    }\n\n    start() {\n        document.body.appendChild(this.canvas);\n        this.screen = new MapScreen(this.canvas, DefaultMap);\n        window.screen = this.screen;\n        this.screen.start();\n    \n        this.canvas.addEventListener(\"click\", (e) => {\n            const rect = this.canvas.getBoundingClientRect();\n            this.screen.handleClick(e.clientX - rect.left, e.clientY - rect.top);\n        });\n\n        this.canvas.addEventListener(\"mousedown\", (e) => {\n            const rect = this.canvas.getBoundingClientRect();\n            this.screen.handleMouseDown(e.clientX - rect.left, e.clientY - rect.top);\n        });\n\n        this.canvas.addEventListener(\"mousemove\", (e) => {\n            const rect = this.canvas.getBoundingClientRect();\n            this.screen.handleMouseMove(e.clientX - rect.left, e.clientY - rect.top);\n        });\n\n        this.canvas.addEventListener(\"mouseup\", (e) => {\n            const rect = this.canvas.getBoundingClientRect();\n            this.screen.handleMouseUp(e.clientX - rect.left, e.clientY - rect.top);\n        });\n\n        this.canvas.addEventListener(\"mouseleave\", (e) => {\n            this.screen.handleMouseLeave();\n        });\n\n        document.addEventListener(\"keydown\", (e) => {\n            e.preventDefault();\n            this.screen.handleKeyDown(e.key);\n        });\n\n        document.addEventListener(\"keyup\", (e) => {\n            e.preventDefault();\n            this.screen.handleKeyUp(e.key);\n        });\n\n        /*this.loadAssets().then(() => {\n\n            this.canvas.addEventListener(\"click\", (e) => {\n                console.log(e);\n            });\n\n            this.loadDemo();\n        });*/\n    }\n\n    loadAssets() {\n        let loadingPromise = new Promise((resolve, reject) => {\n            resolve();\n        });\n        return loadingPromise\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./js/Game.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../node_modules/css-loader/index.js!./main.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../node_modules/css-loader/index.js!./main.css\", function() {\n\t\t\tvar newContent = require(\"!!../node_modules/css-loader/index.js!./main.css\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./css/main.css\n// module id = 2\n// module chunks = 0","import { MapSerializer } from \"./Map\";\n\nvar exampleMapString = \n`p-2 p-1 p-1 p-1\np-1 e-3 p-1 p-1\np-1 p-1 p-1 e-1\np-2 p-2 p-3 p-1\ne-1 e-2 e-1 p-1\np-1 p-2 e-1 p-1\np-1 p-1 p-1 p-1\n===\nk-0-0-0-20\nk-2-1-0-30`;\n\n/*var exampleMapString = \n`p-2 p-1 p-1 p-1\np-1 p-1 p-2 p-1\np-1 p-1 p-2 p-1\n===\nk-0-0-0-20`;*/\n\nconst serializer = new MapSerializer();\nconst defaultMap = serializer.deserialize(exampleMapString);\n\nexport default defaultMap;\n\n\n// WEBPACK FOOTER //\n// ./js/DefaultMap.js","class Tile {\n\n    getClassName() {\n        throw Error('Unimplemented');\n    }\n\n    constructor(x, y, h) {\n        this.x = x;\n        this.y = y;\n        this.h = h;\n        this.left = null;\n        this.right = null;\n        this.top = null;\n        this.down = null;\n        this.highlighted = false;\n        this.mapObject = null;\n    }\n\n    link(dir, tile) {\n        this[dir] = tile;\n    }\n\n    getX() {\n        return this.x;\n    }\n\n    getY() {\n        return this.y;\n    }\n\n    getH() {\n        return this.h;\n    }\n\n    changeNeighbors(steps, highlight, filter=()=>true) {\n        if (steps === 0) {\n            return;\n        }\n        const neighbors = [this.left, this.right, this.top, this.down];\n        neighbors.forEach((tile) => {\n            if (tile !== null && filter(tile)) {\n                if (highlight && !tile.isHighlighted()) {\n                    tile.highlight();\n                    tile.changeNeighbors(steps - 1, highlight, filter);\n                }\n                if (!highlight && tile.isHighlighted()) {\n                    tile.unhighlight();\n                    tile.changeNeighbors(steps - 1, highlight, filter);\n                }\n            }\n        });\n    }\n\n    isHighlighted() {\n        return this.highlighted;\n    }\n\n    highlight() {\n        this.highlighted = true;\n    }\n\n    unhighlight() {\n        this.highlighted = false;\n    }\n\n    setMapObject(mapObject) {\n        this.mapObject = mapObject;\n    }\n\n    unsetMapObject(mapObject) {\n        this.mapObject = null;\n    }\n\n    getMapObject() {\n        return this.mapObject;\n    }\n\n}\n\nclass PlainTile extends Tile {\n\n    getClassName() {\n        return 'Plain';\n    }\n}\n\nclass EmptyTile extends Tile {\n\n    getClassName() {\n        return 'Empty';\n    }\n\n    changeNeighbors(steps, highlight) {\n        return;\n    }\n\n    highlight() {\n        return;\n    }\n\n    unhighlight() {\n        return;\n    }\n}\n\nexport {Tile, EmptyTile, PlainTile};\n\n\n// WEBPACK FOOTER //\n// ./js/Tile.js","import Game from \"./Game\";\nimport \"../css/main.css\"\n\nconst g = new Game(window.innerWidth - 16, window.innerHeight - 16);\ng.start();\n\n\n// WEBPACK FOOTER //\n// ./js/main.js","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n\n\n\n// WEBPACK FOOTER //\n// ./~/css-loader/lib/css-base.js","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./~/style-loader/lib/urls.js","exports = module.exports = require(\"../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \"canvas {\\n\\tborder: 1px solid black;\\n}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader!./css/main.css\n// module id = 8\n// module chunks = 0","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(selector) {\n\t\tif (typeof memo[selector] === \"undefined\") {\n\t\t\tmemo[selector] = fn.call(this, selector);\n\t\t}\n\n\t\treturn memo[selector]\n\t};\n})(function (target) {\n\treturn document.querySelector(target)\n});\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton) options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n\tif (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else {\n\t\tthrow new Error(\"Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\toptions.attrs.type = \"text/css\";\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\toptions.attrs.type = \"text/css\";\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = options.transform(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/style-loader/lib/addStyles.js\n// module id = 9\n// module chunks = 0"],"sourceRoot":""}